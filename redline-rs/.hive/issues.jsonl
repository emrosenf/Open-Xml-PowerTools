{"id":"cell-gpsl8v-mjqmcxmgsko","title":"OOXML Structural Analysis: Rust output vs MS Word gold standard","description":"Deep comparison of internal .docx structure to identify why Rust output fails to open in MS Word. Files: Broken=/tmp/comparison-result.docx, Gold=/Users/evan/Dropbox/Real Estate Deals/Acquired/115 Industrial Ct/Lease Up/Republic/Lease/msword-comparison-2025-12-28.docx","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-29T03:49:10.072Z","updated_at":"2025-12-29T03:54:01.368Z","closed_at":"2025-12-29T03:54:01.368Z","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjqmcxmvimr","title":"Compare ZIP structure - list all files in both archives","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-29T03:49:10.087Z","updated_at":"2025-12-29T03:53:54.840Z","closed_at":"2025-12-29T03:53:54.840Z","parent_id":"cell-gpsl8v-mjqmcxmgsko","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjqmcxmxxu4","title":"Compare [Content_Types].xml between both files","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-29T03:49:10.089Z","updated_at":"2025-12-29T03:53:54.841Z","closed_at":"2025-12-29T03:53:54.841Z","parent_id":"cell-gpsl8v-mjqmcxmgsko","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjqmcxmzxow","title":"Compare word/document.xml structure and content","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-29T03:49:10.091Z","updated_at":"2025-12-29T03:53:54.840Z","closed_at":"2025-12-29T03:53:54.840Z","parent_id":"cell-gpsl8v-mjqmcxmgsko","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjqmcxn11n3","title":"Compare word/styles.xml definitions","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T03:49:10.093Z","updated_at":"2025-12-29T03:53:56.066Z","closed_at":"2025-12-29T03:53:56.066Z","parent_id":"cell-gpsl8v-mjqmcxmgsko","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjqmcxn3c3y","title":"Compare word/settings.xml configuration","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T03:49:10.095Z","updated_at":"2025-12-29T03:53:57.114Z","closed_at":"2025-12-29T03:53:57.114Z","parent_id":"cell-gpsl8v-mjqmcxmgsko","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjqmcxn4yhg","title":"Compare word/_rels/*.rels relationship files","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-29T03:49:10.097Z","updated_at":"2025-12-29T03:53:58.224Z","closed_at":"2025-12-29T03:53:58.224Z","parent_id":"cell-gpsl8v-mjqmcxmgsko","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjqmcxn875a","title":"Compare word/numbering.xml if present","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T03:49:10.100Z","updated_at":"2025-12-29T03:53:59.193Z","closed_at":"2025-12-29T03:53:59.193Z","parent_id":"cell-gpsl8v-mjqmcxmgsko","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjqmcxnapwk","title":"Attempt OOXML validation and report errors","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-29T03:49:10.102Z","updated_at":"2025-12-29T03:54:00.233Z","closed_at":"2025-12-29T03:54:00.233Z","parent_id":"cell-gpsl8v-mjqmcxmgsko","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjqmlicfzvy","title":"Run structure incorrectly merged/collapsed during comparison","description":"Example from paragraph 3:\n- BROKEN: 3 runs\n- GOLD: 43 runs\n\nRuns are being incorrectly merged, losing granular formatting boundaries. Each run in the source document has specific formatting that should be preserved.\n\nAlso causing inflated revision count:\n- w:ins: BROKEN=637 vs GOLD=285 (2.2x more)\n- w:del: BROKEN=160 vs GOLD=71 (2.3x more)\n\nFIX: Preserve original run boundaries when generating comparison. Don't merge adjacent runs even if they have same revision author.","status":"open","priority":1,"issue_type":"bug","created_at":"2025-12-29T03:55:50.175Z","updated_at":"2025-12-29T03:55:50.175Z","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjqmlq14wmi","title":"Missing comment range markers (commentRangeStart/End) in document.xml","description":"BROKEN: 0 commentRangeStart / 0 commentRangeEnd elements\nGOLD: 8 commentRangeStart / 8 commentRangeEnd elements\n\nComments exist in comments.xml but lack the inline anchors needed to display them properly in the document body.\n\nFIX: Preserve comment range markers when generating comparison output.","status":"open","priority":2,"issue_type":"bug","created_at":"2025-12-29T03:56:00.136Z","updated_at":"2025-12-29T03:56:00.136Z","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjqml5l0ghc","title":"Invalid date format in revision elements breaks OOXML validation","description":"BROKEN: w:date=\"2025-12-29T03:42:39.775744+00:00\" (microseconds + offset)\nGOLD: w:date=\"2025-12-28T21:46:00Z\" (OOXML compliant)\n\nOOXML spec requires YYYY-MM-DDTHH:MM:SSZ format. The microseconds and +00:00 timezone offset cause Word to reject the file.\n\nFIX: Use chrono to format as %Y-%m-%dT%H:%M:%SZ (no microseconds, Z suffix not +00:00)","status":"closed","priority":0,"issue_type":"bug","created_at":"2025-12-29T03:55:33.636Z","updated_at":"2025-12-29T04:11:46.026Z","closed_at":"2025-12-29T04:11:46.026Z","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjqml853d1k","title":"Empty w:del elements placed inside w:rPr (invalid OOXML structure)","description":"**RESEARCH COMPLETE - STRUCTURE IS VALID**\n\nAfter thorough investigation (OOXML spec, C# reference code, golden files):\n\nThe pattern `<w:pPr><w:rPr><w:del .../></w:rPr></w:pPr>` is **VALID OOXML** per ECMA-376 schema.\n\n**Evidence:**\n1. OOXML Schema defines `CT_ParaRPr` (rPr inside pPr) as containing `EG_ParaRPrTrackChanges` group which explicitly includes `w:del`\n2. C# OpenXmlPowerTools does exactly this at lines 2707-2710 in WmlComparer.cs\n3. Golden files (WC-1310, WC-1350) contain this exact pattern\n\n**Purpose:** This structure marks the **paragraph mark** (invisible end-of-paragraph character) as deleted, indicating two paragraphs were merged.\n\n**Conclusion:** The original issue description was INCORRECT. This is not an invalid structure. If Word is rejecting files, the problem is likely:\n- Date format issue (separate cell exists for this)\n- Some other XML structural problem\n- Missing required attributes\n\n**Status:** Closing as INVALID - the structure conforms to OOXML spec.","status":"closed","priority":0,"issue_type":"bug","created_at":"2025-12-29T03:55:36.951Z","updated_at":"2025-12-29T04:11:47.884Z","closed_at":"2025-12-29T04:11:47.884Z","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjqmlbn3c8w","title":"Missing paragraph IDs (w14:paraId, w14:textId) and rsid attributes","description":"BROKEN: <w:p>...</w:p> (no attributes)\nGOLD: <w:p w14:paraId=\"69B80CD5\" w14:textId=\"77777777\" w:rsidR=\"00356315\" ...>\n\nMissing:\n- w14:paraId - paragraph identifier\n- w14:textId - text identifier  \n- rsidR, rsidRPr, rsidP - revision session IDs\n\nStats: BROKEN has 2 rsid occurrences vs GOLD's 2,314\n\nFIX: Preserve these attributes from source document paragraphs. Generate valid 8-char hex values for rsid if creating new elements.","status":"closed","priority":0,"issue_type":"bug","created_at":"2025-12-29T03:55:41.487Z","updated_at":"2025-12-29T04:11:49.890Z","closed_at":"2025-12-29T04:11:49.890Z","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjqmlgyayjh","title":"Run formatting (w:rPr) stripped when wrapping in w:ins/w:del revisions","description":"100% formatting loss when creating revision markup:\n\n| Lost Element | Count |\n|--------------|-------|\n| w:szCs (font size) | 517 |\n| w:b (bold) | 429 |\n| w:jc (justify) | 212 |\n| w:u (underline) | 200 |\n| w:color | 120 |\n| w:bCs | 100 |\n| w:ind | 62 |\n| w:rFonts | 18 |\n| TOTAL | 1,715 |\n\nBROKEN: <w:r><w:t>text</w:t></w:r>\nGOLD: <w:r><w:rPr><w:b/><w:szCs w:val=\"24\"/></w:rPr><w:t>text</w:t></w:r>\n\nFIX: When wrapping runs in w:ins/w:del, preserve the inner w:rPr formatting from source document.","status":"closed","priority":0,"issue_type":"bug","created_at":"2025-12-29T03:55:48.370Z","updated_at":"2025-12-29T04:11:51.771Z","closed_at":"2025-12-29T04:11:51.771Z","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjqnayekk7c","title":"BLOCKER: footnotes.xml missing w:p wrapper around w:pPr","description":"Schema violation causing Word to reject file.\n\nBROKEN:\n```xml\n<w:footnote w:id=\"1\">\n  <w:pPr>  <!-- INVALID: pPr directly inside footnote -->\n    <w:pStyle w:val=\"FootnoteText\"/>\n  </w:pPr>\n  <w:r>...</w:r>\n</w:footnote>\n```\n\nCORRECT:\n```xml\n<w:footnote w:id=\"1\">\n  <w:p w14:paraId=\"...\" w14:textId=\"...\" w:rsidR=\"...\">\n    <w:pPr>\n      <w:pStyle w:val=\"FootnoteText\"/>\n    </w:pPr>\n    <w:r>...</w:r>\n  </w:p>\n</w:footnote>\n```\n\nOOXML schema requires: w:footnote → w:p → w:pPr\n\nFIX: Ensure footnote content is always wrapped in w:p element during serialization.","status":"closed","priority":0,"issue_type":"bug","created_at":"2025-12-29T04:15:37.388Z","updated_at":"2025-12-29T12:23:33.323Z","closed_at":"2025-12-29T12:23:33.323Z","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjqnb4bow73","title":"Comments missing w:annotationRef element and CommentReference style","description":"Our comments are missing required child elements:\n- w:annotationRef: 0 (GOLD has 8)\n- w:rStyle=\"CommentReference\": 0 (GOLD has 8)\n- w:pStyle=\"CommentText\": 0 (GOLD has 3)\n\nFIX: Add annotationRef element as first child of comment content runs. Apply proper styles.","status":"open","priority":2,"issue_type":"bug","created_at":"2025-12-29T04:15:45.060Z","updated_at":"2025-12-29T04:15:45.060Z","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjqmlkdfdox","title":"Content incorrectly routed to footnotes.xml instead of document.xml","description":"Size discrepancy suggests content routing issue:\n\ndocument.xml: BROKEN=194KB, GOLD=377KB (49% of expected size)\nfootnotes.xml: BROKEN=55KB, GOLD=3.5KB (15.8x larger than expected)\n\nThe ~183KB missing from document.xml may be incorrectly going to footnotes.xml.\n\nFIX: Investigate comparison logic to ensure content is routed to correct XML part.","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-29T03:55:52.803Z","updated_at":"2025-12-29T12:48:24.486Z","closed_at":"2025-12-29T12:48:24.486Z","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjqmlnx28nd","title":"Missing style references (pStyle/rStyle) in document.xml content","description":"BROKEN: 0 style references in document.xml\nGOLD: 6 style references (CommentReference, DeltaViewInsertion, FootnoteReference, Hyperlink, Legal3, StyleHeading211ptChar)\n\nAlso missing:\n- 357 empty <w:rPr/> elements in BROKEN vs 1 in GOLD\n- No pStyle elements to link paragraphs to defined styles\n\nThe styles.xml is correct, but document.xml isn't referencing the styles.\n\nFIX: Preserve pStyle and rStyle references when generating comparison output.","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-29T03:55:57.398Z","updated_at":"2025-12-29T12:48:22.168Z","closed_at":"2025-12-29T12:48:22.168Z","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjqnb1o8tfu","title":"Missing w16du:dateUtc attribute on revision elements","description":"Our output has 0 w16du:dateUtc attributes, GOLD has 359.\n\nBROKEN: <w:ins w:author=\"Redline\" w:id=\"2\" w:date=\"2025-12-29T04:13:54Z\">\nGOLD: <w:ins w:id=\"1\" w:author=\"...\" w:date=\"...\" w16du:dateUtc=\"2025-12-29T02:46:00Z\">\n\nModern Word expects w16du:dateUtc for proper timezone handling.\n\nFIX: Add w16du:dateUtc attribute with UTC timestamp to all w:ins and w:del elements.","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-29T04:15:41.624Z","updated_at":"2025-12-29T12:48:20.784Z","closed_at":"2025-12-29T12:48:20.784Z","dependencies":[],"labels":[],"comments":[]}
