{"id":"cell-gpsl8v-mjqmcxmgsko","title":"OOXML Structural Analysis: Rust output vs MS Word gold standard","description":"Deep comparison of internal .docx structure to identify why Rust output fails to open in MS Word. Files: Broken=/tmp/comparison-result.docx, Gold=/Users/evan/Dropbox/Real Estate Deals/Acquired/115 Industrial Ct/Lease Up/Republic/Lease/msword-comparison-2025-12-28.docx","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-29T03:49:10.072Z","updated_at":"2025-12-29T03:54:01.368Z","closed_at":"2025-12-29T03:54:01.368Z","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjqmcxmvimr","title":"Compare ZIP structure - list all files in both archives","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-29T03:49:10.087Z","updated_at":"2025-12-29T03:53:54.840Z","closed_at":"2025-12-29T03:53:54.840Z","parent_id":"cell-gpsl8v-mjqmcxmgsko","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjqmcxmxxu4","title":"Compare [Content_Types].xml between both files","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-29T03:49:10.089Z","updated_at":"2025-12-29T03:53:54.841Z","closed_at":"2025-12-29T03:53:54.841Z","parent_id":"cell-gpsl8v-mjqmcxmgsko","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjqmcxmzxow","title":"Compare word/document.xml structure and content","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-29T03:49:10.091Z","updated_at":"2025-12-29T03:53:54.840Z","closed_at":"2025-12-29T03:53:54.840Z","parent_id":"cell-gpsl8v-mjqmcxmgsko","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjqmcxn11n3","title":"Compare word/styles.xml definitions","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T03:49:10.093Z","updated_at":"2025-12-29T03:53:56.066Z","closed_at":"2025-12-29T03:53:56.066Z","parent_id":"cell-gpsl8v-mjqmcxmgsko","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjqmcxn3c3y","title":"Compare word/settings.xml configuration","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T03:49:10.095Z","updated_at":"2025-12-29T03:53:57.114Z","closed_at":"2025-12-29T03:53:57.114Z","parent_id":"cell-gpsl8v-mjqmcxmgsko","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjqmcxn4yhg","title":"Compare word/_rels/*.rels relationship files","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-29T03:49:10.097Z","updated_at":"2025-12-29T03:53:58.224Z","closed_at":"2025-12-29T03:53:58.224Z","parent_id":"cell-gpsl8v-mjqmcxmgsko","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjqmcxn875a","title":"Compare word/numbering.xml if present","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T03:49:10.100Z","updated_at":"2025-12-29T03:53:59.193Z","closed_at":"2025-12-29T03:53:59.193Z","parent_id":"cell-gpsl8v-mjqmcxmgsko","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjqmcxnapwk","title":"Attempt OOXML validation and report errors","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-29T03:49:10.102Z","updated_at":"2025-12-29T03:54:00.233Z","closed_at":"2025-12-29T03:54:00.233Z","parent_id":"cell-gpsl8v-mjqmcxmgsko","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjqml5l0ghc","title":"Invalid date format in revision elements breaks OOXML validation","description":"BROKEN: w:date=\"2025-12-29T03:42:39.775744+00:00\" (microseconds + offset)\nGOLD: w:date=\"2025-12-28T21:46:00Z\" (OOXML compliant)\n\nOOXML spec requires YYYY-MM-DDTHH:MM:SSZ format. The microseconds and +00:00 timezone offset cause Word to reject the file.\n\nFIX: Use chrono to format as %Y-%m-%dT%H:%M:%SZ (no microseconds, Z suffix not +00:00)","status":"closed","priority":0,"issue_type":"bug","created_at":"2025-12-29T03:55:33.636Z","updated_at":"2025-12-29T04:11:46.026Z","closed_at":"2025-12-29T04:11:46.026Z","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjqml853d1k","title":"Empty w:del elements placed inside w:rPr (invalid OOXML structure)","description":"**RESEARCH COMPLETE - STRUCTURE IS VALID**\n\nAfter thorough investigation (OOXML spec, C# reference code, golden files):\n\nThe pattern `<w:pPr><w:rPr><w:del .../></w:rPr></w:pPr>` is **VALID OOXML** per ECMA-376 schema.\n\n**Evidence:**\n1. OOXML Schema defines `CT_ParaRPr` (rPr inside pPr) as containing `EG_ParaRPrTrackChanges` group which explicitly includes `w:del`\n2. C# OpenXmlPowerTools does exactly this at lines 2707-2710 in WmlComparer.cs\n3. Golden files (WC-1310, WC-1350) contain this exact pattern\n\n**Purpose:** This structure marks the **paragraph mark** (invisible end-of-paragraph character) as deleted, indicating two paragraphs were merged.\n\n**Conclusion:** The original issue description was INCORRECT. This is not an invalid structure. If Word is rejecting files, the problem is likely:\n- Date format issue (separate cell exists for this)\n- Some other XML structural problem\n- Missing required attributes\n\n**Status:** Closing as INVALID - the structure conforms to OOXML spec.","status":"closed","priority":0,"issue_type":"bug","created_at":"2025-12-29T03:55:36.951Z","updated_at":"2025-12-29T04:11:47.884Z","closed_at":"2025-12-29T04:11:47.884Z","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjqmlbn3c8w","title":"Missing paragraph IDs (w14:paraId, w14:textId) and rsid attributes","description":"BROKEN: <w:p>...</w:p> (no attributes)\nGOLD: <w:p w14:paraId=\"69B80CD5\" w14:textId=\"77777777\" w:rsidR=\"00356315\" ...>\n\nMissing:\n- w14:paraId - paragraph identifier\n- w14:textId - text identifier  \n- rsidR, rsidRPr, rsidP - revision session IDs\n\nStats: BROKEN has 2 rsid occurrences vs GOLD's 2,314\n\nFIX: Preserve these attributes from source document paragraphs. Generate valid 8-char hex values for rsid if creating new elements.","status":"closed","priority":0,"issue_type":"bug","created_at":"2025-12-29T03:55:41.487Z","updated_at":"2025-12-29T04:11:49.890Z","closed_at":"2025-12-29T04:11:49.890Z","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjqmlgyayjh","title":"Run formatting (w:rPr) stripped when wrapping in w:ins/w:del revisions","description":"100% formatting loss when creating revision markup:\n\n| Lost Element | Count |\n|--------------|-------|\n| w:szCs (font size) | 517 |\n| w:b (bold) | 429 |\n| w:jc (justify) | 212 |\n| w:u (underline) | 200 |\n| w:color | 120 |\n| w:bCs | 100 |\n| w:ind | 62 |\n| w:rFonts | 18 |\n| TOTAL | 1,715 |\n\nBROKEN: <w:r><w:t>text</w:t></w:r>\nGOLD: <w:r><w:rPr><w:b/><w:szCs w:val=\"24\"/></w:rPr><w:t>text</w:t></w:r>\n\nFIX: When wrapping runs in w:ins/w:del, preserve the inner w:rPr formatting from source document.","status":"closed","priority":0,"issue_type":"bug","created_at":"2025-12-29T03:55:48.370Z","updated_at":"2025-12-29T04:11:51.771Z","closed_at":"2025-12-29T04:11:51.771Z","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjqnayekk7c","title":"BLOCKER: footnotes.xml missing w:p wrapper around w:pPr","description":"Schema violation causing Word to reject file.\n\nBROKEN:\n```xml\n<w:footnote w:id=\"1\">\n  <w:pPr>  <!-- INVALID: pPr directly inside footnote -->\n    <w:pStyle w:val=\"FootnoteText\"/>\n  </w:pPr>\n  <w:r>...</w:r>\n</w:footnote>\n```\n\nCORRECT:\n```xml\n<w:footnote w:id=\"1\">\n  <w:p w14:paraId=\"...\" w14:textId=\"...\" w:rsidR=\"...\">\n    <w:pPr>\n      <w:pStyle w:val=\"FootnoteText\"/>\n    </w:pPr>\n    <w:r>...</w:r>\n  </w:p>\n</w:footnote>\n```\n\nOOXML schema requires: w:footnote → w:p → w:pPr\n\nFIX: Ensure footnote content is always wrapped in w:p element during serialization.","status":"closed","priority":0,"issue_type":"bug","created_at":"2025-12-29T04:15:37.388Z","updated_at":"2025-12-29T12:23:33.323Z","closed_at":"2025-12-29T12:23:33.323Z","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjqmlkdfdox","title":"Content incorrectly routed to footnotes.xml instead of document.xml","description":"Size discrepancy suggests content routing issue:\n\ndocument.xml: BROKEN=194KB, GOLD=377KB (49% of expected size)\nfootnotes.xml: BROKEN=55KB, GOLD=3.5KB (15.8x larger than expected)\n\nThe ~183KB missing from document.xml may be incorrectly going to footnotes.xml.\n\nFIX: Investigate comparison logic to ensure content is routed to correct XML part.","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-29T03:55:52.803Z","updated_at":"2025-12-29T12:48:24.486Z","closed_at":"2025-12-29T12:48:24.486Z","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjqmlnx28nd","title":"Missing style references (pStyle/rStyle) in document.xml content","description":"BROKEN: 0 style references in document.xml\nGOLD: 6 style references (CommentReference, DeltaViewInsertion, FootnoteReference, Hyperlink, Legal3, StyleHeading211ptChar)\n\nAlso missing:\n- 357 empty <w:rPr/> elements in BROKEN vs 1 in GOLD\n- No pStyle elements to link paragraphs to defined styles\n\nThe styles.xml is correct, but document.xml isn't referencing the styles.\n\nFIX: Preserve pStyle and rStyle references when generating comparison output.","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-29T03:55:57.398Z","updated_at":"2025-12-29T12:48:22.168Z","closed_at":"2025-12-29T12:48:22.168Z","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjqnb1o8tfu","title":"Missing w16du:dateUtc attribute on revision elements","description":"Our output has 0 w16du:dateUtc attributes, GOLD has 359.\n\nBROKEN: <w:ins w:author=\"Redline\" w:id=\"2\" w:date=\"2025-12-29T04:13:54Z\">\nGOLD: <w:ins w:id=\"1\" w:author=\"...\" w:date=\"...\" w16du:dateUtc=\"2025-12-29T02:46:00Z\">\n\nModern Word expects w16du:dateUtc for proper timezone handling.\n\nFIX: Add w16du:dateUtc attribute with UTC timestamp to all w:ins and w:del elements.","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-29T04:15:41.624Z","updated_at":"2025-12-29T12:48:20.784Z","closed_at":"2025-12-29T12:48:20.784Z","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjr8brf3fgt","title":"Fix missing text content and paragraph wrapping in WML comparison","description":"Debug why text content (w:t elements) is being lost during comparison. Gold standard has 2625 w:t elements but our output only has 856. Runs are created but empty.","status":"open","priority":1,"issue_type":"epic","created_at":"2025-12-29T14:04:06.927Z","updated_at":"2025-12-29T14:04:06.927Z","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjr8brfkkr3","title":"Trace atom_list creation to understand ContentElement to XML conversion","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-29T14:04:06.944Z","updated_at":"2025-12-29T14:04:06.944Z","parent_id":"cell-gpsl8v-mjr8brf3fgt","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjr8brfgjqe","title":"Investigate coalesce.rs text generation - find where w:t elements should be created","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-29T14:04:06.940Z","updated_at":"2025-12-29T15:00:38.724Z","closed_at":"2025-12-29T15:00:38.724Z","parent_id":"cell-gpsl8v-mjr8brf3fgt","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjr8brfigq3","title":"Investigate C# reference implementation for text content handling in WmlComparer","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-29T14:04:06.942Z","updated_at":"2025-12-29T15:00:39.086Z","closed_at":"2025-12-29T15:00:39.086Z","parent_id":"cell-gpsl8v-mjr8brf3fgt","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjr8brfmgn4","title":"Implement fix for missing text content based on investigation findings","description":"ROOT CAUSE IDENTIFIED: Text atoms missing \"t\" in ancestor chain.\n\n**The Bug:**\n- Text atoms have ancestors `[body, p, r]` but should have `[body, p, r, t]`\n- `coalesce_recurse` groups by ancestor at each level\n- Since \"t\" is missing, `reconstruct_text_elements` is NEVER called\n- Result: Empty runs without text content\n\n**The Fix:**\nIn `atom_list.rs`, when creating Text atoms, ensure the \"t\" element is included in the ancestor chain. Look at how paragraph atoms include the paragraph in their chain (the recent debug code shows: `ancestors.insert(0, build_ancestor_info_for_node(doc, node))`).\n\n**C# Reference:**\n- C# Line 5406 extracts text: `gc.Select(gce => gce.ContentElement.Value).StringConcatenate()`\n- Atoms with ContentElement containing characters get concatenated into `<w:t>text</w:t>`\n\n**Expected Result:**\nAfter fix, running comparison should produce runs with text content, matching gold standard's 2625 w:t elements.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T14:04:06.946Z","updated_at":"2025-12-29T15:16:16.398Z","closed_at":"2025-12-29T15:16:16.398Z","parent_id":"cell-gpsl8v-mjr8brf3fgt","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjqmlicfzvy","title":"Run structure incorrectly merged/collapsed during comparison","description":"Example from paragraph 3:\n- BROKEN: 3 runs\n- GOLD: 43 runs\n\nRuns are being incorrectly merged, losing granular formatting boundaries. Each run in the source document has specific formatting that should be preserved.\n\nAlso causing inflated revision count:\n- w:ins: BROKEN=637 vs GOLD=285 (2.2x more)\n- w:del: BROKEN=160 vs GOLD=71 (2.3x more)\n\nFIX: Preserve original run boundaries when generating comparison. Don't merge adjacent runs even if they have same revision author.","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-29T03:55:50.175Z","updated_at":"2025-12-29T15:46:31.197Z","closed_at":"2025-12-29T15:46:31.197Z","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjrazncjbgw","title":"Fix run merging and revision fragmentation in WML comparison","description":"Address two related issues in WML document comparison:\n1. Run over-merging: 43 runs → 3 runs (losing original formatting boundaries)\n2. Revision over-fragmentation: 285 w:ins → 637 w:ins (2.2x inflation)\n\nRoot cause: UNID-based grouping in group_adjacent_by_correlation_ranges creates artificial boundaries while losing original run structure from source documents.","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-29T15:18:40.627Z","updated_at":"2025-12-29T15:46:42.183Z","closed_at":"2025-12-29T15:46:42.183Z","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjrazncqdkc","title":"Investigate run boundary loss: analyze why 43 runs become 3","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T15:18:40.634Z","updated_at":"2025-12-29T15:35:06.652Z","closed_at":"2025-12-29T15:35:06.652Z","parent_id":"cell-gpsl8v-mjrazncjbgw","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjrazncy1fc","title":"Investigate revision fragmentation: analyze why 285 w:ins becomes 637","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T15:18:40.642Z","updated_at":"2025-12-29T15:35:07.847Z","closed_at":"2025-12-29T15:35:07.847Z","parent_id":"cell-gpsl8v-mjrazncjbgw","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjraznd0ojl","title":"Implement fix for run boundary preservation","description":"INVESTIGATION FINDINGS:\nRoot cause: Empty UNIDs cause grouping key to be \"|{status}\" for all atoms.\n\nFIX REQUIRED:\n1. In comparer.rs, verify assign_unid_to_all_elements is called BEFORE atom creation\n2. Check preprocessing flow: is it called for both documents?\n3. Look at compare_part_content - does it call preprocess_markup which calls assign_unid_to_all_elements?\n\nALTERNATIVE FIX (if UNIDs are being assigned but lost):\nIn coalesce.rs group_adjacent_by_correlation_ranges, add fallback for empty UNIDs:\n- If ancestor_unid is empty, use atom index or original node_id as synthetic UNID\n- This preserves run boundaries even when UNIDs are missing","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T15:18:40.644Z","updated_at":"2025-12-29T15:46:27.598Z","closed_at":"2025-12-29T15:46:27.598Z","parent_id":"cell-gpsl8v-mjrazncjbgw","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjraznd2ho4","title":"Implement fix for revision coalescing","description":"INVESTIGATION FINDINGS:\nRoot cause: Grouping key at line 1654/1657 is \"{unid}|{status}\" - different source runs create separate groups.\n\nFIX REQUIRED in coalesce.rs group_adjacent_by_correlation_ranges (lines 1641-1658):\nFor Inserted/Deleted correlation status, EXCLUDE ancestor_unid from grouping key:\n\nChange from:\n  format!(\"{}|{}\", ancestor_unid, status_str)\n\nTo:\n  if status == Inserted || status == Deleted {\n    format!(\"{}|SIG:{}\", status_str, formatting_signature)  // No UNID\n  } else {\n    format!(\"{}|{}\", ancestor_unid, status_str)  // Keep UNID for Equal\n  }\n\nRATIONALE:\n- Insertions/deletions don't need to preserve source run boundaries\n- They should form continuous revision blocks\n- Equal content needs UNIDs to maintain source structure","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T15:18:40.646Z","updated_at":"2025-12-29T15:46:29.150Z","closed_at":"2025-12-29T15:46:29.150Z","parent_id":"cell-gpsl8v-mjrazncjbgw","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjraznd36jd","title":"Verify fix against gold standard comparison","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T15:18:40.647Z","updated_at":"2025-12-29T15:46:41.058Z","closed_at":"2025-12-29T15:46:41.058Z","parent_id":"cell-gpsl8v-mjrazncjbgw","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjrc9guj9th","title":"Fix MS Word compatibility - output file won't open","description":"The comparison output file cannot be opened in MS Word. Need comprehensive investigation comparing our output to the gold standard to identify structural/content issues causing the incompatibility.","status":"open","priority":1,"issue_type":"epic","created_at":"2025-12-29T15:54:18.379Z","updated_at":"2025-12-29T15:54:18.379Z","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjrc9guok9u","title":"Validate XML structure and find malformed elements","description":"FINDINGS:\n1. 242 empty &lt;w:rPr/&gt; elements (gold has 1) - CRITICAL\n2. Attribute order wrong: w:author before w:id (should be w:id first per ECMA-376)\n3. Missing bookmarkStart/bookmarkEnd elements (0 vs 6)\n\nFIX NEEDED:\n- Don't emit empty w:rPr elements\n- Fix attribute order on w:ins/w:del\n- Preserve bookmark elements","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-29T15:54:18.384Z","updated_at":"2025-12-29T15:58:42.945Z","closed_at":"2025-12-29T15:58:42.945Z","parent_id":"cell-gpsl8v-mjrc9guj9th","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjrc9guq8q6","title":"Compare document.xml structure with gold standard","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-29T15:54:18.386Z","updated_at":"2025-12-29T15:58:44.324Z","closed_at":"2025-12-29T15:58:44.324Z","parent_id":"cell-gpsl8v-mjrc9guj9th","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjrc9gusqfu","title":"Check Content_Types, relationships and package structure","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-29T15:54:18.388Z","updated_at":"2025-12-29T15:58:45.738Z","closed_at":"2025-12-29T15:58:45.738Z","parent_id":"cell-gpsl8v-mjrc9guj9th","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjrc9guur6s","title":"Identify namespace and attribute differences","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-29T15:54:18.390Z","updated_at":"2025-12-29T15:58:46.505Z","closed_at":"2025-12-29T15:58:46.505Z","parent_id":"cell-gpsl8v-mjrc9guj9th","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjrcfgw8rbk","title":"Fix empty w:rPr elements (242 vs 1 in gold)","description":"CRITICAL: Our output has 242 empty &lt;w:rPr/&gt; elements vs 1 in gold standard.\n\nEmpty w:rPr elements are non-standard and may cause schema validation errors in MS Word.\n\nFIX: In coalesce.rs, don't emit w:rPr element when there are no run properties to include.\n\nLook for code that creates w:rPr and add check: if rPr has no children, don't add it.","status":"closed","priority":0,"issue_type":"bug","created_at":"2025-12-29T15:58:58.376Z","updated_at":"2025-12-29T16:09:02.310Z","closed_at":"2025-12-29T16:09:02.310Z","parent_id":"cell-gpsl8v-mjrc9guj9th","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjrcfjcky15","title":"Fix w:ins/w:del attribute order (w:id must come first)","description":"CRITICAL: Attribute order on w:ins/w:del is wrong.\n\nOur output: w:author=\"Redline\" w:id=\"2\" w:date=\"...\"\nGold standard: w:id=\"1\" w:author=\"David Reed\" w:date=\"...\"\n\nPer ECMA-376, w:id should come first. This may cause Word to reject the file.\n\nFIX: In revision.rs or coalesce.rs where w:ins/w:del are created, ensure attributes are added in order: w:id, w:author, w:date","status":"closed","priority":0,"issue_type":"bug","created_at":"2025-12-29T15:59:01.556Z","updated_at":"2025-12-29T16:09:03.750Z","closed_at":"2025-12-29T16:09:03.750Z","parent_id":"cell-gpsl8v-mjrc9guj9th","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjrcfkr4kg3","title":"Preserve bookmarkStart/bookmarkEnd elements","description":"Our output has 0 bookmarks, gold has 6 bookmarkStart/bookmarkEnd pairs.\n\nBookmarks may be getting stripped during comparison. Need to preserve them.\n\nCheck: atom_list.rs for how bookmarks are handled, coalesce.rs for reconstruction.","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-29T15:59:03.376Z","updated_at":"2025-12-29T16:19:16.172Z","closed_at":"2025-12-29T16:19:16.172Z","parent_id":"cell-gpsl8v-mjrc9guj9th","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjrcfm23xl7","title":"Fix revision ID to start at 0 (not 1)","description":"Our revision IDs start at 1 (w:id=\"1\", \"2\", \"3\"...)\nGold standard starts at 0 (w:id=\"0\", \"1\", \"2\"...)\n\nFIX: In revision.rs, change the revision ID counter to start at 0 instead of 1.","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-29T15:59:05.067Z","updated_at":"2025-12-29T16:19:17.298Z","closed_at":"2025-12-29T16:19:17.298Z","parent_id":"cell-gpsl8v-mjrc9guj9th","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjrcxmezizo","title":"Fix MS Word Compatibility Issues - Phase 2","description":"Fix remaining MS Word compatibility issues: revision ID starting at 0, preserve bookmarks, and fix empty rPr removal. All three are independent fixes that can run in parallel.","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-29T16:13:05.339Z","updated_at":"2025-12-29T16:19:23.488Z","closed_at":"2025-12-29T16:19:23.488Z","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjrcxmf6g1f","title":"Fix revision ID counter to start at 0 instead of 1","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T16:13:05.346Z","updated_at":"2025-12-29T16:19:06.293Z","closed_at":"2025-12-29T16:19:06.293Z","parent_id":"cell-gpsl8v-mjrcxmezizo","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjrcxmfeiil","title":"Preserve bookmarkStart and bookmarkEnd elements","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T16:13:05.354Z","updated_at":"2025-12-29T16:19:08.397Z","closed_at":"2025-12-29T16:19:08.397Z","parent_id":"cell-gpsl8v-mjrcxmezizo","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjrcxmfg39q","title":"Debug and fix empty w:rPr element removal","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T16:13:05.356Z","updated_at":"2025-12-29T16:19:10.109Z","closed_at":"2025-12-29T16:19:10.109Z","parent_id":"cell-gpsl8v-mjrcxmezizo","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjrcxmfhjrx","title":"Integration test - verify all fixes work together","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T16:13:05.357Z","updated_at":"2025-12-29T16:19:25.225Z","closed_at":"2025-12-29T16:19:25.225Z","parent_id":"cell-gpsl8v-mjrcxmezizo","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjrdbak0wd1","title":"Bookmark preservation requires special handling in atom_list/coalesce","description":"Removing bookmarkStart/bookmarkEnd from elements_to_throw_away() is not enough. These elements fall through to the recursive case at the end of create_atom_list_recurse() but since they have no children, they're effectively ignored.\n\nBookmarks need special handling:\n1. Track bookmark elements during atom creation (store their position and attributes)\n2. Reconstruct bookmarks during coalesce at the correct positions\n\nThis is similar to how commentRangeStart/End should be handled.\n\nSource doc has 6 bookmark pairs, output has 0.","status":"open","priority":1,"issue_type":"bug","created_at":"2025-12-29T16:23:43.152Z","updated_at":"2025-12-29T16:23:43.152Z","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjrf3xtq73p","title":"Add XML well-formedness validation test","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-29T17:13:59.294Z","updated_at":"2025-12-29T17:13:59.294Z","parent_id":"cell-gpsl8v-mjrf3xthnpd","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjrf3xtytry","title":"Verify fix with real document comparison and MS Word","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-29T17:13:59.302Z","updated_at":"2025-12-29T17:13:59.302Z","parent_id":"cell-gpsl8v-mjrf3xthnpd","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjrfzq2nf4r","title":"Fix OOXML comparison XML structure issues","description":"Address gaps between redline-rs output and MS Word gold standard: comment range markers, text element count, and revision markup balance. Current state: w:t 1658 vs 2625 (-37%), w:del 56 vs 181 (-69%), w:ins 406 vs 285 (+42%), commentRange* 0 vs 8 (-100%).","status":"open","priority":1,"issue_type":"epic","created_at":"2025-12-29T17:38:42.239Z","updated_at":"2025-12-29T17:38:42.239Z","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjrfzq3394p","title":"Add XML structure validation test suite","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-29T17:38:42.255Z","updated_at":"2025-12-29T17:38:42.255Z","parent_id":"cell-gpsl8v-mjrfzq2nf4r","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjqmlq14wmi","title":"Missing comment range markers (commentRangeStart/End) in document.xml","description":"BROKEN: 0 commentRangeStart / 0 commentRangeEnd elements\nGOLD: 8 commentRangeStart / 8 commentRangeEnd elements\n\nComments exist in comments.xml but lack the inline anchors needed to display them properly in the document body.\n\nFIX: Preserve comment range markers when generating comparison output.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-29T03:56:00.136Z","updated_at":"2025-12-29T19:08:14.950Z","closed_at":"2025-12-29T19:08:14.950Z","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjqnb4bow73","title":"Comments missing w:annotationRef element and CommentReference style","description":"Our comments are missing required child elements:\n- w:annotationRef: 0 (GOLD has 8)\n- w:rStyle=\"CommentReference\": 0 (GOLD has 8)\n- w:pStyle=\"CommentText\": 0 (GOLD has 3)\n\nFIX: Add annotationRef element as first child of comment content runs. Apply proper styles.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-29T04:15:45.060Z","updated_at":"2025-12-29T19:08:15.570Z","closed_at":"2025-12-29T19:08:15.570Z","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjrf3xthnpd","title":"Fix malformed XML output causing Word to refuse opening document","description":"Output has 246 unclosed <w:p> tags and 584 unclosed <w:r> tags. Root cause is in coalesce.rs XML reconstruction logic. Must maintain C# parity.","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-29T17:13:59.285Z","updated_at":"2025-12-29T19:15:30.425Z","closed_at":"2025-12-29T19:15:30.425Z","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjrf3xto6ts","title":"Investigate bug and fix element tag closing in coalesce.rs","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-29T17:13:59.292Z","updated_at":"2025-12-29T19:15:29.277Z","closed_at":"2025-12-29T19:15:29.277Z","parent_id":"cell-gpsl8v-mjrf3xthnpd","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjrfzq2uynz","title":"Preserve comment range markers in atom processing","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T17:38:42.246Z","updated_at":"2025-12-29T19:08:13.102Z","closed_at":"2025-12-29T19:08:13.102Z","parent_id":"cell-gpsl8v-mjrfzq2nf4r","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjrfzq2w12z","title":"Fix w:del under-representation (56 vs 181)","description":"COMBINED TASK: Fix both w:del under-representation AND unclosed XML tags in coalesce.rs\n\nCRITICAL BUG #1 (P0): Unclosed XML element tags\n- 246 unclosed <w:p> tags (opens: 683, closes: 437, self-closing: 288)\n- 584 unclosed <w:r> tags (opens: 1767, closes: 1183, self-closing: 133)\n- Word refuses to open the file\n\nISSUE #2 (P1): w:del under-representation  \n- Output has only 56 w:del elements vs gold standard's 181 (-69% deficit)\n\nThese are likely related - the unclosed tags may be causing deletion content to be lost or malformed.\n\nSTEPS:\n1. FIRST: Fix the unclosed tag issue - trace coalesce_recurse(), reconstruct_paragraph_elements(), reconstruct_run_elements()\n2. THEN: Verify w:del count improves\n3. If still low, trace deletion status propagation\n\nC# REFERENCE: /Users/evan/development/openxml-worktree/rust-port-phase0/OpenXmlPowerTools/WmlComparer.cs","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T17:38:42.248Z","updated_at":"2025-12-29T19:15:31.666Z","closed_at":"2025-12-29T19:15:31.666Z","parent_id":"cell-gpsl8v-mjrfzq2nf4r","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjrfzq30mdj","title":"Add annotationRef and comment styles to generated comments","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T17:38:42.252Z","updated_at":"2025-12-29T19:08:14.022Z","closed_at":"2025-12-29T19:08:14.022Z","parent_id":"cell-gpsl8v-mjrfzq2nf4r","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjrg0qjdg98","title":"Fix unclosed XML element tags in coalesce.rs (246 w:p, 584 w:r)","description":"CRITICAL BUG: Word refuses to open output file because XML is malformed.\n\nROOT CAUSE: document.xml has 246 unclosed <w:p> tags and 584 unclosed <w:r> tags.\n\nSTATISTICS FROM BROKEN OUTPUT:\n- <w:p> opens: 683, closes: 437, self-closing: 288 → UNBALANCED by 246\n- <w:r> opens: 1767, closes: 1183, self-closing: 133 → UNBALANCED by 584\n\nINVESTIGATE:\nTrace through coalesce.rs to identify exactly where element tags are not being properly closed. Bug is likely in:\n1. coalesce_recurse() - may not emit closing tags\n2. reconstruct_paragraph_elements() - may skip closing tags for paragraphs  \n3. reconstruct_run_elements() - may skip closing tags for runs\n4. Element reconstruction from atoms during the coalesce phase\n\nFIX REQUIREMENTS:\n1. Ensure every opening <w:p> has matching </w:p> or is self-closing\n2. Ensure every opening <w:r> has matching </w:r> or is self-closing\n3. Handle edge cases: empty paragraphs, nested revisions, deleted content\n4. Match C# WmlComparer output structure exactly\n\nVALIDATION: Run comparison and verify:\n- Count of <w:p>, </w:p>, <w:p/> must balance\n- Count of <w:r>, </w:r>, <w:r/> must balance\n\nC# REFERENCE: /Users/evan/development/openxml-worktree/rust-port-phase0/OpenXmlPowerTools/WmlComparer.cs","status":"closed","priority":0,"issue_type":"bug","created_at":"2025-12-29T17:39:29.497Z","updated_at":"2025-12-29T17:39:45.746Z","closed_at":"2025-12-29T17:39:45.746Z","parent_id":"cell-gpsl8v-mjrfzq2nf4r","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjrfzq2ycrs","title":"Fix w:ins over-fragmentation (406 vs 285)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T17:38:42.250Z","updated_at":"2025-12-29T20:53:55.271Z","closed_at":"2025-12-29T20:53:55.271Z","parent_id":"cell-gpsl8v-mjrfzq2nf4r","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjrku28ggvf","title":"MS Word cannot open comparison output - investigate OOXML structure","description":"CRITICAL: MS Word refuses to open the comparison output file.\n\nROOT CAUSE FOUND (Dec 29 investigation):\nThe footnotes.xml has malformed structure - pPr and r elements appear DIRECTLY under w:footnote instead of being wrapped in a w:p element.\n\nBROKEN OUTPUT:\n```xml\n<w:footnote w:id=\"1\">\n  <w:pPr>...</w:pPr>      <!-- ❌ INVALID: Should be inside w:p -->\n  <w:r>...</w:r>          <!-- ❌ INVALID: Should be inside w:p -->\n  <w:p>...</w:p>          <!-- Second paragraph is OK -->\n</w:footnote>\n```\n\nEXPECTED (GOLD STANDARD):\n```xml\n<w:footnote w:id=\"1\">\n  <w:p>                   <!-- ✅ Paragraph wrapper required -->\n    <w:pPr>...</w:pPr>\n    <w:r>...</w:r>\n  </w:p>\n</w:footnote>\n```\n\nSUSPECTED ISSUE LOCATION:\nThe coalesce logic in `crates/redline-core/src/wml/coalesce.rs` function `coalesce_recurse` at level 0 is not properly wrapping footnote content in paragraphs.\n\nPossible causes:\n1. First paragraph's atoms have wrong/missing ancestor_unids at level 0\n2. The grouping key at level 0 causes atoms to bypass `reconstruct_paragraph`\n3. The atom creation in `atom_list.rs` for footnotes doesn't properly set ancestor chain\n\nKEY FILES:\n- crates/redline-core/src/wml/coalesce.rs (coalesce_recurse, reconstruct_paragraph)\n- crates/redline-core/src/wml/atom_list.rs (create_atom_list_recurse for footnotes)\n- crates/redline-core/src/wml/comparer.rs (process_notes, assemble_ancestor_unids)\n\nTEST COMMAND:\n```bash\n./target/release/redline compare \\\n  --source1 \"/Users/evan/Dropbox/Real Estate Deals/Acquired/115 Industrial Ct/Lease Up/Republic/Lease/Version 20699_2 Lease (11-19-25) - LL 1.11.docx\" \\\n  --source2 \"/Users/evan/Dropbox/Real Estate Deals/Acquired/115 Industrial Ct/Lease Up/Republic/Lease/Lease (BFI Rev 12-11-25).docx\" \\\n  --output /tmp/comparison-result.docx\n\n# Then extract and check footnotes:\nunzip -p /tmp/comparison-result.docx word/footnotes.xml | xmllint --format - | head -50\n```","status":"closed","priority":0,"issue_type":"bug","created_at":"2025-12-29T19:54:16.144Z","updated_at":"2025-12-29T20:48:27.800Z","closed_at":"2025-12-29T20:48:27.800Z","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjrne72glgf","title":"Fix WML corruption and add revision metadata config (FAILURE_REPORT scope B)","description":"Address critical issues from FAILURE_REPORT.md: (1) Empty w:drawing elements causing corruption, (2) Deletion/insertion count mismatch vs gold standard, (3) Add configurable author/date for revision metadata. Scope excludes: rId remapping parity, text run merging parity.","status":"open","priority":1,"issue_type":"epic","created_at":"2025-12-29T21:05:54.760Z","updated_at":"2025-12-29T21:05:54.760Z","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjrne72udut","title":"Investigate and fix deletion count parity (34 vs 71 expected)","description":"Investigation complete: LCS algorithm is too permissive - matching content as Equal/Unknown that should be Deleted. Likely culprits: detail_threshold application, hash-based matching thresholds (lines 332-352), common prefix/suffix detection. Needs comparison with C# WmlComparer.cs lines 5779-7255.","status":"blocked","priority":0,"issue_type":"task","created_at":"2025-12-29T21:05:54.774Z","updated_at":"2025-12-29T21:12:50.136Z","parent_id":"cell-gpsl8v-mjrne72glgf","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjrne72wot7","title":"Investigate and fix insertion count parity (412 vs 285 expected)","description":"Investigation complete: count_revisions_in_subtree has issues - doesn't handle Math/Image revisions properly, only groups adjacent siblings within each recursion level. Coalescing may not be merging w:ins elements optimally.","status":"blocked","priority":0,"issue_type":"task","created_at":"2025-12-29T21:05:54.776Z","updated_at":"2025-12-29T21:12:52.598Z","parent_id":"cell-gpsl8v-mjrne72glgf","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjrne72xi6x","title":"Add author/date configuration to WmlComparerSettings and CLI","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T21:05:54.777Z","updated_at":"2025-12-29T21:12:45.030Z","closed_at":"2025-12-29T21:12:45.030Z","parent_id":"cell-gpsl8v-mjrne72glgf","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjrne730int","title":"Create regression test with gold standard comparison counts","description":"Blocked: Waiting for deletion/insertion parity fixes to be implemented before creating regression tests.","status":"blocked","priority":1,"issue_type":"task","created_at":"2025-12-29T21:05:54.780Z","updated_at":"2025-12-29T21:13:00.783Z","parent_id":"cell-gpsl8v-mjrne72glgf","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjrne72s8j3","title":"Fix empty w:drawing elements - preserve child tree during relationship processing","description":"CONFIRMED: Empty w:drawing elements in 3 locations - paraIds 768A2224, 4D11F53B, 776E6BA6 (Exhibits A-1.1, A-1.2, A-1.3). Pattern: w:r > w:rPr + w:drawing/ (self-closing, missing wp:inline/wp:anchor children).","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-29T21:05:54.773Z","updated_at":"2025-12-29T21:37:23.434Z","closed_at":"2025-12-29T21:37:23.434Z","parent_id":"cell-gpsl8v-mjrne72glgf","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjrvp4er66h","title":"Fix whitespace handling discrepancies vs MS Word gold standard","description":"Fix three specific whitespace issues in redline-rs comparison output:\n1. Section 3.4: Extra newlines not in gold standard\n2. Section 4 (rent table): Extra spaces that look like tabs\n3. Section 4.1: Missing tab character in TBD deletion\n\nGold: /Users/evan/Dropbox/Real Estate Deals/Acquired/115 Industrial Ct/Lease Up/Republic/Lease/msword-comparison-2025-12-28.docx\nSource1: Version 20699_2 Lease (11-19-25) - LL 1.11.docx\nSource2: Lease (BFI Rev 12-11-25).docx","status":"open","priority":1,"issue_type":"epic","created_at":"2025-12-30T00:58:21.459Z","updated_at":"2025-12-30T00:58:21.459Z","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjrvp4f2tx6","title":"Add golden regression tests for whitespace handling","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-30T00:58:21.470Z","updated_at":"2025-12-30T00:58:21.470Z","parent_id":"cell-gpsl8v-mjrvp4er66h","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjrvp4exk13","title":"Investigate: Extract and diff sections 3.4, 4, 4.1 from gold vs Rust output","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-30T00:58:21.465Z","updated_at":"2025-12-30T01:04:28.077Z","closed_at":"2025-12-30T01:04:28.077Z","parent_id":"cell-gpsl8v-mjrvp4er66h","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjrvp4ezzmp","title":"Fix extra newlines in section 3.4","description":"**Root Cause Found:** Rust includes 4 empty paragraphs with `w:rsidDel` attribute that MS Word filters out.\n\n**Fix:** In coalesce.rs, filter out empty paragraphs that have `w:rsidDel` attribute during reconstruction.\n\n**Evidence from INVESTIGATION_FINDINGS.md:**\n```xml\n<!-- Rust incorrectly includes these deleted paragraphs -->\n<w:p w14:paraId=\"6E472136\" w:rsidDel=\"008448C0\" .../>\n<w:p w14:paraId=\"1B5C0135\" w:rsidDel=\"008448C0\" .../>\n```\n\nMS Word gold standard does NOT include these - they should be filtered.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-30T00:58:21.467Z","updated_at":"2025-12-30T01:10:32.230Z","closed_at":"2025-12-30T01:10:32.230Z","parent_id":"cell-gpsl8v-mjrvp4er66h","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjrwh3dnt5p","title":"Deep trace: Track changes lost during comparison (68 vs 181 w:del)","description":"Investigation found 68 w:del elements in Rust output vs 181 in gold standard - 63% of track changes are being lost.\n\nWorker analysis found the code logic APPEARS correct:\n- Tab/Break atoms get pt:Status=\"Deleted\" attribute\n- handle_run_element checks for this attribute\n- But deletions aren't being wrapped in w:del\n\nNeeds systematic trace to find where deletion status is lost in the flow:\n1. Add debug logging at atom extraction\n2. Add debug logging at comparison step\n3. Add debug logging at reconstruction\n4. Find where Deleted status atoms are NOT producing w:del wrapper\n\nFiles: coalesce.rs, atom_list.rs, lcs_algorithm.rs","status":"open","priority":1,"issue_type":"bug","created_at":"2025-12-30T01:20:06.491Z","updated_at":"2025-12-30T01:20:06.491Z","parent_id":"cell-gpsl8v-mjrvp4er66h","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjrc4hkto75","title":"Investigate remaining w:t gap to gold standard (1658 vs 2625)","description":"After fixes for text content and revision fragmentation, there's still a gap:\n\nCurrent state:\n- w:t: 1658 (gold: 2625) - ~967 missing text elements\n- w:ins: 406 (gold: 285) - still 1.4x more insertions\n- w:del: 28 (gold: 71) - now BELOW gold, possible over-coalescing\n\nInvestigation areas:\n1. Check if text is missing from specific document parts (footnotes, headers, comments)\n2. Verify w:del isn't being over-coalesced (28 vs gold 71)\n3. Investigate remaining w:ins inflation (406 vs 285)\n4. Check if some runs are still being incorrectly merged despite UNID fix\n\nTest command:\n./target/release/redline compare \\\n  --source1 \"/Users/evan/Dropbox/Real Estate Deals/Acquired/115 Industrial Ct/Lease Up/Republic/Lease/Version 20699_2 Lease (11-19-25) - LL 1.11.docx\" \\\n  --source2 \"/Users/evan/Dropbox/Real Estate Deals/Acquired/115 Industrial Ct/Lease Up/Republic/Lease/Lease (BFI Rev 12-11-25).docx\" \\\n  --output /tmp/comparison-result.docx","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T15:50:26.045Z","updated_at":"2025-12-30T15:44:48.620Z","closed_at":"2025-12-30T15:44:48.620Z","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjrvp4f05m6","title":"Fix tab/space handling in rent table and 4.1 deletion","description":"PARTIALLY FIXED: Added currency symbols ($, €, £, etc.) to word_separators so $TBD becomes two words: $ + TBD. This allows $ to match as equal content while TBD is marked as deleted. However, the broader issue of 64% track changes being lost (68 w:del vs 181 in gold standard) remains - this is a separate deeper issue in the LCS/coalesce logic.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-30T00:58:21.468Z","updated_at":"2025-12-30T15:44:48.759Z","closed_at":"2025-12-30T15:44:48.759Z","parent_id":"cell-gpsl8v-mjrvp4er66h","dependencies":[],"labels":[],"comments":[]}
{"id":"cell-gpsl8v-mjspgcyihqm","title":"Fix remaining 11 wml_tests failures","description":"Investigate and fix remaining 9 wml_tests failures (Table revisions). French tests (wc_1970, wc_1980) are fixed. Fixed critical corruption issue (empty revisions).","status":"in_progress","priority":1,"issue_type":"bug","created_at":"2025-12-30T14:51:21.114Z","updated_at":"2025-12-30T15:44:49.244Z","dependencies":[],"labels":[],"comments":[]}
