{"id":"cell--tsysh-mjn0oh7mgrm","title":"Phase 2: WmlComparer Port (Faithful Translation)","description":"**Phase 2: WmlComparer Port (100% Faithful C# Translation)**\n\n## Methodology (NON-NEGOTIABLE)\n1. **Translation-first**: Port C# code line-by-line, preserving structure and naming\n2. **No behavior inference**: Never guess what C# does from test outputs\n3. **Tests validate, not guide**: Run tests only AFTER implementation complete\n4. **When stuck**: Read C# source (WmlComparer.cs:line), not test expectations\n5. **Naming convention**: Rust functions mirror C# method names\n\n## Source Files to Port\n- WmlComparer.cs (8836 lines) - Main comparer\n- RevisionProcessor.cs (~800 lines) - Accept/Reject revisions\n- MarkupSimplifier.cs (~600 lines) - Markup preprocessing\n\n## Target: 539 WML tests pass (268 + 251 + 20 formatting)\n\n## Reference: RUST_MIGRATION_PLAN_SYNTHESIS.md Section 2","status":"open","priority":1,"issue_type":"epic","created_at":"2025-12-26T15:18:58.594Z","updated_at":"2025-12-26T15:49:25.493Z","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjn1jkfdtjc","title":"WmlComparer Performance Analysis & Rust Optimization","description":"Analyze performance hotspots in WmlComparer and provide Rust implementation optimizations while maintaining byte-for-byte compatibility","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-26T15:43:09.097Z","updated_at":"2025-12-26T15:49:16.216Z","closed_at":"2025-12-26T15:49:16.216Z","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjn1jkfiicu","title":"Analyze Atomization Performance Hotspots","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-26T15:43:09.102Z","updated_at":"2025-12-26T15:43:14.918Z","closed_at":"2025-12-26T15:43:14.918Z","parent_id":"cell--tsysh-mjn1jkfdtjc","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjn1jkfkk15","title":"Analyze LCS Algorithm Quadratic Complexity","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-26T15:43:09.104Z","updated_at":"2025-12-26T15:43:20.843Z","closed_at":"2025-12-26T15:43:20.843Z","parent_id":"cell--tsysh-mjn1jkfdtjc","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjn1jkflqv3","title":"Analyze Coalescing & XML Traversal Costs","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-26T15:43:09.105Z","updated_at":"2025-12-26T15:43:26.056Z","closed_at":"2025-12-26T15:43:26.056Z","parent_id":"cell--tsysh-mjn1jkfdtjc","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjn1jkfnmvo","title":"Design Optimized Rust Data Structures","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-26T15:43:09.107Z","updated_at":"2025-12-26T15:43:33.904Z","closed_at":"2025-12-26T15:43:33.904Z","parent_id":"cell--tsysh-mjn1jkfdtjc","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjn1jkfpw9w","title":"Implement Memory-Efficient LCS Algorithm","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-26T15:43:09.109Z","updated_at":"2025-12-26T15:43:38.512Z","closed_at":"2025-12-26T15:43:38.512Z","parent_id":"cell--tsysh-mjn1jkfdtjc","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjn1jkfqdsq","title":"Optimize Atomization with Streaming Approach","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-26T15:43:09.110Z","updated_at":"2025-12-26T15:43:42.989Z","closed_at":"2025-12-26T15:43:42.989Z","parent_id":"cell--tsysh-mjn1jkfdtjc","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjn1jkfs9rn","title":"Add Performance Benchmarks","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-26T15:43:09.112Z","updated_at":"2025-12-26T15:43:47.261Z","closed_at":"2025-12-26T15:43:47.261Z","parent_id":"cell--tsysh-mjn1jkfdtjc","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjn0oh7t5sd","title":"2.1 Types and Settings","description":"**Port WmlComparerSettings and WmlComparerRevision**\n\nFiles: wml/settings.rs (update existing)\n\n## C# Sources\n- WmlComparerSettings (WmlComparer.cs:64-100)\n- WmlComparerConsolidateSettings (WmlComparer.cs:109)\n- WmlRevisedDocumentInfo (WmlComparer.cs:114)\n- WmlComparerRevision + WmlComparerRevisionType (WmlComparer.cs:3861-3884)\n\n## Fields to Port (EXACT defaults required)\n- WordSeparators: char[] with Chinese punctuation (line 100)\n- AuthorForRevisions: Option<String>\n- DateTimeForRevisions: ISO 8601 format\n- DetailThreshold: f64 = 0.15\n- CaseInsensitive: bool = false\n- ConflateBreakingAndNonbreakingSpaces: bool = true\n- TrackFormattingChanges: bool = true\n- CultureInfo: Option<String>\n- StartingIdForFootnotesEndnotes: i32 = 1\n\n## Rust File: redline-rs/crates/redline-core/src/wml/settings.rs","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-26T15:18:58.601Z","updated_at":"2025-12-26T16:17:00.981Z","closed_at":"2025-12-26T16:17:00.981Z","parent_id":"cell--tsysh-mjn0oh7mgrm","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjn0oh7v9ah","title":"2.2 Comparison Units","description":"**Port ComparisonUnit Hierarchy**\n\nFiles: wml/comparison_unit.rs (rewrite for faithful port)\n\n## C# Sources (WmlComparer.cs)\n- ComparisonUnit abstract base (line 8157-8210)\n- ComparisonUnitWord (line 8212-8278)\n- ComparisonUnitAtom (line 8280-8596)\n- ComparisonUnitGroup (line 8608-8690)\n- ComparisonUnitGroupType enum (line 8599-8606)\n- CorrelationStatus enum (line 8597)\n\n## Critical Fields in ComparisonUnitAtom\n- AncestorElements: XElement[] (body â†’ leaf order)\n- AncestorUnids: String[]\n- ContentElement: XElement\n- Part: OpenXmlPart reference\n- SHA1Hash: computed from content\n- CorrelationStatus: Equal/Inserted/Deleted/Unknown\n- NormalizedRPr: for formatting comparison\n- FormattingSignature: String hash of rPr\n\n## Rust File: redline-rs/crates/redline-core/src/wml/comparison_unit.rs","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-26T15:18:58.603Z","updated_at":"2025-12-26T16:17:01.335Z","closed_at":"2025-12-26T16:17:01.335Z","parent_id":"cell--tsysh-mjn0oh7mgrm","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjn0oh7xg1i","title":"2.3 RevisionProcessor Port","description":"**Port RevisionProcessor (AcceptRevisions/RejectRevisions)**\n\nFiles: NEW wml/revision_processor.rs\n\n## C# Sources\n- RevisionProcessor.cs (full file ~800 lines)\n- Used by CompareInternal at lines 226-227, 255-256\n\n## Methods to Port\n1. AcceptRevisions(WmlDocument) â†’ WmlDocument\n2. RejectRevisions(WmlDocument) â†’ WmlDocument\n3. AcceptRevisionsForElement(element) - element-level accept\n\n## Purpose in Compare Flow\n1. source1afterAccepting = AcceptRevisions(source1)\n2. source2afterRejecting = RejectRevisions(source2)\n3. Used for HashBlockLevelContent correlation\n4. Re-accept after hashing for actual comparison\n\n## Rust File: redline-rs/crates/redline-core/src/wml/revision_processor.rs","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-26T15:18:58.605Z","updated_at":"2025-12-26T16:17:01.863Z","closed_at":"2025-12-26T16:17:01.863Z","parent_id":"cell--tsysh-mjn0oh7mgrm","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjn0oh7yx5o","title":"2.4 MarkupSimplifier Port","description":"**Port MarkupSimplifier**\n\nFiles: NEW wml/simplify.rs\n\n## C# Sources\n- MarkupSimplifier.cs (full file ~600 lines)\n- Called by PreProcessMarkup in WmlComparer\n\n## Key Operations\n1. Merge adjacent runs with same formatting\n2. Remove empty runs and paragraphs\n3. Normalize bookmarks and fields\n4. Handle tracked changes cleanup\n5. Process alternate content (MC:AlternateContent)\n\n## Rust File: redline-rs/crates/redline-core/src/wml/simplify.rs","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-26T15:18:58.606Z","updated_at":"2025-12-26T16:17:02.293Z","closed_at":"2025-12-26T16:17:02.293Z","parent_id":"cell--tsysh-mjn0oh7mgrm","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjn0oh85k0v","title":"2.8 Formatting Changes","description":"**Port Formatting Change Detection**\n\nFiles: wml/formatting.rs (update existing)\n\n## C# Sources (WmlComparer.cs)\n- NormalizedRPr computation (line 8380-8466)\n- FormattingSignature generation (line 8298-8310)\n- FormattingChangeRPrBefore handling (line 8300-8345)\n- rPrChange generation in CoalesceRecurse\n\n## Key Logic\n1. Compute NormalizedRPr from w:rPr element\n2. Generate SHA1 FormattingSignature from normalized props\n3. Compare signatures between matched atoms\n4. Generate w:rPrChange elements for format differences\n5. Use TrackFormattingChanges setting\n\n## Rust File: redline-rs/crates/redline-core/src/wml/formatting.rs","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-26T15:18:58.613Z","updated_at":"2025-12-26T16:38:52.267Z","closed_at":"2025-12-26T16:38:52.267Z","parent_id":"cell--tsysh-mjn0oh7mgrm","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjn0oh86fdp","title":"2.9 Tree Reconstruction","description":"**Port CoalesceRecurse (Tree Reconstruction)**\n\nFiles: wml/coalesce.rs (rewrite for faithful port)\n\n## C# Sources (WmlComparer.cs)\n- Coalesce() entry (line 7977-7992)\n- CoalesceRecurse() (line 5161-5738)\n- MoveLastSectPrToChildOfBody (line 7987)\n- AssembleAncestorUnidsInOrderToRebuildXmlTreeProperly (line 5043-5012)\n\n## Grouping Logic (CRITICAL)\n1. Group atoms by AncestorUnids[level]\n2. Also group by CorrelationStatus (don't merge across status boundaries)\n3. Also group by FormattingSignature (format change boundaries)\n4. Recurse at each level to build hierarchy\n\n## Special Cases\n- VML/textbox handling (preserve \"before ancestors\")\n- Table structure reconstruction\n- Empty key handling (drop from grouping)\n\n## Rust File: redline-rs/crates/redline-core/src/wml/coalesce.rs","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-26T15:18:58.614Z","updated_at":"2025-12-26T16:38:53.178Z","closed_at":"2025-12-26T16:38:53.178Z","parent_id":"cell--tsysh-mjn0oh7mgrm","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjn0oh88t77","title":"2.10 Element Ordering","description":"**Port Element Ordering + MarkContentAsDeletedOrInserted**\n\nFiles: wml/order.rs, wml/mark_revisions.rs\n\n## C# Sources\n- WmlOrderElementsPerStandard (PtOpenXmlUtil.cs)\n- Order_pPr, Order_rPr dictionaries\n- MarkContentAsDeletedOrInserted (WmlComparer.cs:2646)\n- MarkContentAsDeletedOrInsertedTransform (line 2652-2740)\n- FixUpRevisionIds (line 2742-2965)\n\n## Element Ordering\n- Ensure output XML element order matches OOXML standard\n- Critical for: pPr, rPr, tblPr, tcPr, trPr\n\n## Revision Markup Transform\n1. For w:r: wrap in w:del or w:ins based on PtOpenXml.Status\n2. For w:pPr: inject w:rPr with w:del or w:ins markers\n3. Add w:author, w:id, w:date attributes\n4. Sequential ID assignment (s_MaxId++)\n\n## Rust Files: \n- redline-rs/crates/redline-core/src/wml/order.rs\n- redline-rs/crates/redline-core/src/wml/mark_revisions.rs","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-26T15:18:58.616Z","updated_at":"2025-12-26T16:38:54.967Z","closed_at":"2025-12-26T16:38:54.967Z","parent_id":"cell--tsysh-mjn0oh7mgrm","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjn0oh8axgq","title":"2.11 Consolidation","description":"**Port Consolidate + GetRevisions**\n\nFiles: wml/consolidate.rs, wml/get_revisions.rs\n\n## C# Sources (WmlComparer.cs)\n- Consolidate() overloads (line 994-1040)\n- ConsolidateInternal (line 1042-1800)\n- ConsolidationInfo class (internal)\n- GetRevisions() (line 3887-3960)\n- WmlComparerRevision extraction logic\n\n## Consolidate Logic\n1. Compare original with each revised document\n2. Merge revision markup from multiple authors\n3. Handle overlapping revisions\n4. Color-code by author (ColorParser)\n\n## GetRevisions Logic\n1. Find all w:ins, w:del elements in document\n2. Extract text, author, date, revision type\n3. Return List<WmlComparerRevision>\n\n## Rust Files:\n- redline-rs/crates/redline-core/src/wml/consolidate.rs\n- redline-rs/crates/redline-core/src/wml/get_revisions.rs","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-26T15:18:58.618Z","updated_at":"2025-12-26T16:38:56.249Z","closed_at":"2025-12-26T16:38:56.249Z","parent_id":"cell--tsysh-mjn0oh7mgrm","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjn0oh80z4a","title":"2.5 Preprocessing","description":"**Port PreProcessMarkup Pipeline**\n\nFiles: wml/preprocess.rs (update existing)\n\n## C# Sources (WmlComparer.cs)\n- PreProcessMarkup (line ~175-225)\n- AssignUnidToAllElements (line 8136)\n- HashBlockLevelContent (line 241-242)\n- MoveLastSectPrIntoLastParagraph (line 7994)\n\n## Pipeline Steps (EXACT order required)\n1. SimplifyMarkup() - normalize document\n2. AssignUnidToAllElements() - add pt:Unid GUIDs\n3. Accept/Reject revisions for hashing\n4. HashBlockLevelContent() - add pt:SHA1Hash, pt:CorrelatedSHA1Hash\n5. Repair Unids after SDK revision acceptance\n\n## Rust File: redline-rs/crates/redline-core/src/wml/preprocess.rs","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-26T15:18:58.608Z","updated_at":"2025-12-26T16:54:10.866Z","closed_at":"2025-12-26T16:54:10.866Z","parent_id":"cell--tsysh-mjn0oh7mgrm","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjn0oh8250l","title":"2.6 LCS Algorithm","description":"**Port Full LCS Algorithm**\n\nFiles: wml/lcs.rs (rewrite for faithful port)\n\n## C# Sources (WmlComparer.cs)\n- Lcs main loop (line 5779-5936)\n- SetAfterUnids (line 5848-5936)\n- ProcessCorrelatedHashes (line 5938-6137)\n- FindCommonAtBeginningAndEnd (line 4489-4972)\n- DoLcsAlgorithm (line 6148-6724)\n- DoLcsAlgorithmForTable (line 7145)\n- DetectUnrelatedSources (line 5745)\n\n## Decision Chain (EXACT order in loop)\n1. SetAfterUnids(unknown) - propagate GUIDs\n2. ProcessCorrelatedHashes(unknown) - hash-driven matching\n3. FindCommonAtBeginningAndEnd(unknown) - prefix/suffix trim\n4. DoLcsAlgorithm(unknown) - core LCS search\n\n## DetailThreshold Gate\n- Discard matches below 15% of total window\n\n## Rust File: redline-rs/crates/redline-core/src/wml/lcs.rs","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-26T15:18:58.610Z","updated_at":"2025-12-26T16:54:12.637Z","closed_at":"2025-12-26T16:54:12.637Z","parent_id":"cell--tsysh-mjn0oh7mgrm","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjn4ppbizoa","title":"Deep Analysis of WmlComparer C# Implementation","description":"Analyze the C# WmlComparer implementation focusing on LCS algorithm, ContentAtom comparison, CorrelationStatus logic, hash-based equality checks, and edge case handling.","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-26T17:11:54.222Z","updated_at":"2025-12-26T17:12:20.944Z","closed_at":"2025-12-26T17:12:20.944Z","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjn4ppboxp0","title":"Analyze LCS Algorithm Implementation","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-26T17:11:54.228Z","updated_at":"2025-12-26T17:11:58.307Z","closed_at":"2025-12-26T17:11:58.307Z","parent_id":"cell--tsysh-mjn4ppbizoa","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjn4ppbq8u8","title":"Examine ContentAtom Comparison Logic","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-26T17:11:54.230Z","updated_at":"2025-12-26T17:12:02.334Z","closed_at":"2025-12-26T17:12:02.334Z","parent_id":"cell--tsysh-mjn4ppbizoa","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjn4ppbslxv","title":"Review CorrelationStatus Assignment","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-26T17:11:54.232Z","updated_at":"2025-12-26T17:12:06.487Z","closed_at":"2025-12-26T17:12:06.487Z","parent_id":"cell--tsysh-mjn4ppbizoa","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjn4ppbu7k6","title":"Investigate Hash-Based Equality Checks","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-26T17:11:54.234Z","updated_at":"2025-12-26T17:12:10.630Z","closed_at":"2025-12-26T17:12:10.630Z","parent_id":"cell--tsysh-mjn4ppbizoa","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjn4ppbwoy5","title":"Document Edge Case Handling","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-26T17:11:54.236Z","updated_at":"2025-12-26T17:12:14.885Z","closed_at":"2025-12-26T17:12:14.885Z","parent_id":"cell--tsysh-mjn4ppbizoa","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjn4ppbx8v4","title":"Synthesize Findings and Create Report","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-26T17:11:54.237Z","updated_at":"2025-12-26T17:12:18.919Z","closed_at":"2025-12-26T17:12:18.919Z","parent_id":"cell--tsysh-mjn4ppbizoa","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjn4tjeucs9","title":"Fix LCS Algorithm Bugs in Rust Port","description":"Address critical bugs in the Rust port of the C# LCS algorithm that could cause incorrect document comparison results","status":"open","priority":1,"issue_type":"epic","created_at":"2025-12-26T17:14:53.190Z","updated_at":"2025-12-26T17:14:53.190Z","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjn4tjf3bdw","title":"Add regression tests for LCS algorithm edge cases","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-26T17:14:53.199Z","updated_at":"2025-12-26T17:14:53.199Z","parent_id":"cell--tsysh-mjn4tjeucs9","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjn0oh83tby","title":"2.7 Core Comparison","description":"**Port Core Comparison (ProduceDocumentWithTrackedRevisions)**\n\nFiles: wml/comparer.rs (rewrite for faithful port)\n\n## Status: Pipeline Complete, Revision Counting Issue\n\nThe full pipeline is now wired up:\n1. âœ… PreProcessMarkup both docs\n2. âœ… CreateComparisonUnitAtomList on each part\n3. âœ… GetComparisonUnitList â†’ hierarchical grouping\n4. âœ… Lcs() â†’ correlate sequences\n5. âœ… FlattenToComparisonUnitAtomList â†’ back to atoms\n6. âœ… CoalesceRecurse â†’ rebuild XML tree\n7. âœ… XML serialization to result document bytes\n\n## Current Issue\nTests show 0 revisions for most text-change scenarios. The `count_revision_atoms` \nfunction gets no Inserted/Deleted atoms from `flatten_to_atoms`. Either:\n- Atoms aren't being extracted correctly\n- LCS is treating everything as Equal\n- Or the hash comparison is matching when it shouldn't\n\nNeeds debugging at the atom extraction level to trace why text changes\naren't generating Deleted/Inserted statuses.\n\n## Rust File: redline-rs/crates/redline-core/src/wml/comparer.rs","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-26T15:18:58.611Z","updated_at":"2025-12-26T20:37:02.512Z","closed_at":"2025-12-26T20:37:02.512Z","parent_id":"cell--tsysh-mjn0oh7mgrm","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjn4tjf0tzr","title":"Fix flatten_to_atoms Equal case to use correct document content","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-26T17:14:53.196Z","updated_at":"2025-12-26T20:37:04.514Z","closed_at":"2025-12-26T20:37:04.514Z","parent_id":"cell--tsysh-mjn4tjeucs9","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjn4tjf25oj","title":"Add missing count_common_at_end == 2 logic in find_common_at_beginning_and_end","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-26T17:14:53.198Z","updated_at":"2025-12-26T20:47:35.504Z","closed_at":"2025-12-26T20:47:35.504Z","parent_id":"cell--tsysh-mjn4tjeucs9","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnelpk5g6p","title":"LCS Algorithm C# Parity Gaps (from Synthesis Report)","description":"**Status:** ðŸ”´ CRITICAL - NOT PRODUCTION READY\n\nImplementation gaps identified in SYNTHESIS_LCS_GAP_ANALYSIS.md (Dec 26, 2025).\nRust LCS algorithm is ~60% complete compared to C# reference.\n\n**Total Missing Logic:** ~500-600 lines of critical C# code\n**Estimated Effort:** 6-8 weeks with dedicated resource\n\n## Gap Summary\n- P0-1: Paragraph boundary preservation in DoLcsAlgorithm (4-5 days)\n- P0-2: Table merged cell detection (2-3 days)  \n- P0-3: Content type grouping logic (3-4 days)\n- P1-1: Paragraph-aware splitting in FindCommonAtBeginningAndEnd (1-2 days)\n\n## Source\nSee: history/SYNTHESIS_LCS_GAP_ANALYSIS.md","status":"open","priority":1,"issue_type":"epic","created_at":"2025-12-26T21:48:44.069Z","updated_at":"2025-12-26T21:48:44.069Z","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnelpkwuoq","title":"Create test suite for merged cell tables","description":"**Priority:** P1\n**Effort:** 1-2 days\n\n## Purpose\nValidate that merged cell detection (P0-2b) works correctly.\n\n## Test Cases Needed\n1. Simple table (no merged cells) - should return false\n2. Table with horizontal merge (gridSpan) - should return true\n3. Table with vertical merge (vMerge) - should return true\n4. Table with both horizontal and vertical merges - should return true\n5. Nested table with merged cells in inner table\n6. Comparing two tables where one has merged cells\n\n## Test Documents\nCreate test DOCX files with various merged cell configurations.\n\n## Reference\n- Source: history/SYNTHESIS_LCS_GAP_ANALYSIS.md (Testing section)\n- Validates: P0-2b implementation","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-26T21:48:44.096Z","updated_at":"2025-12-26T21:49:41.108Z","parent_id":"cell--tsysh-mjnelpk5g6p","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnelpkzs8z","title":"Create test suite for mixed content scenarios","description":"**Priority:** P1\n**Effort:** 1-2 days\n\n## Purpose\nValidate that mixed content handling (P0-3a, P0-3b, P0-3c) works correctly.\n\n## Test Cases Needed\n1. Paragraph followed by table - insertion/deletion ordering\n2. Table followed by paragraph - insertion/deletion ordering\n3. Alternating paragraphs and tables\n4. Paragraph ending with text vs paragraph ending with para mark\n5. Table row adjacent to paragraph\n6. Cell content vs word content comparison\n\n## Test Documents\nCreate test DOCX files with various mixed content configurations.\n\n## Reference\n- Source: history/SYNTHESIS_LCS_GAP_ANALYSIS.md (Testing section)\n- Validates: P0-3a, P0-3b, P0-3c implementations","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-26T21:48:44.099Z","updated_at":"2025-12-26T21:49:44.091Z","parent_id":"cell--tsysh-mjnelpk5g6p","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnelpl1wn7","title":"Create test suite for paragraph boundary edge cases","description":"**Priority:** P1\n**Effort:** 1-2 days\n\n## Purpose\nValidate that paragraph boundary preservation (P0-1) works correctly.\n\n## Test Cases Needed\n1. LCS match spans paragraph boundary - should split correctly\n2. Content before paragraph in left only - should be Deleted\n3. Content before paragraph in right only - should be Inserted\n4. Content before paragraph in both - should be Unknown\n5. LCS ends mid-paragraph - should extend to next para mark\n6. Multiple paragraphs with partial matches\n7. Empty paragraph handling\n8. Paragraph with only whitespace\n\n## Test Documents\nCreate test DOCX files with various paragraph boundary scenarios.\n\n## Reference\n- Source: history/SYNTHESIS_LCS_GAP_ANALYSIS.md (Testing section)\n- Validates: P0-1, P0-1a implementations","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-26T21:48:44.101Z","updated_at":"2025-12-26T21:49:46.858Z","parent_id":"cell--tsysh-mjnelpk5g6p","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnelpke7yi","title":"P0-1a: Implement FindIndexOfNextParaMark helper","description":"**C# Lines:** 7133-7143 (~10 lines)\n**Effort:** 0.5 days\n\n## Required Implementation\nHelper function to find the index of the next paragraph mark in a ComparisonUnit array.\n\n```csharp\n// C# 7133-7143\nprivate static int FindIndexOfNextParaMark(ComparisonUnit[] cua, int start) {\n    for (int i = start; i < cua.Length; i++) {\n        if (IsParagraphMark(cua[i]))\n            return i;\n    }\n    return -1;\n}\n```\n\n## Dependency\nRequired by P0-1 (paragraph boundary preservation) for post-LCS paragraph extension logic.\n\n## Reference\n- Source: history/SYNTHESIS_LCS_GAP_ANALYSIS.md (P0-1)\n- C# Source: OpenXmlPowerTools/WmlComparer.cs:7133-7143","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-26T21:48:44.078Z","updated_at":"2025-12-26T21:54:53.558Z","closed_at":"2025-12-26T21:54:53.558Z","parent_id":"cell--tsysh-mjnelpk5g6p","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnq4vcg827","title":"Fix Remaining 15 WML Comparer Test Failures (89â†’104 passing)","description":"Investigate and fix the remaining 15 failing WML comparer tests. Tests improved from 68â†’89 after namespace and hash fixes. Remaining failures are categorized by root cause area.","status":"open","priority":1,"issue_type":"epic","created_at":"2025-12-27T03:11:33.808Z","updated_at":"2025-12-27T03:11:33.808Z","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnq4vcwfra","title":"Investigate Revision Counting Edge Cases (wc_1180, wc_2040)","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-27T03:11:33.824Z","updated_at":"2025-12-27T03:11:33.824Z","parent_id":"cell--tsysh-mjnq4vcg827","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnq4vcydyb","title":"Investigate French Locale Failures (wc_1970, wc_1980)","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-27T03:11:33.826Z","updated_at":"2025-12-27T03:11:33.826Z","parent_id":"cell--tsysh-mjnq4vcg827","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnq4vcmhvj","title":"Investigate Endnote Failures (wc_1710, wc_1720)","description":"INVESTIGATION COMPLETE: Rust compares entire endnotes.xml as one part, while C# compares each endnote individually per reference ID. Need to refactor process_notes() to iterate per-reference.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-27T03:11:33.814Z","updated_at":"2025-12-27T03:17:43.163Z","closed_at":"2025-12-27T03:17:43.159Z","parent_id":"cell--tsysh-mjnq4vcg827","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnq4vco0ro","title":"Investigate Textbox/VML Failures (wc_1930, wc_2090, wc_2092)","description":"INVESTIGATION COMPLETE: Missing NormalizeTxbxContentAncestorUnids (~230 lines C#). Need to enhance assemble_ancestor_unids with textbox support and implement normalize_txbx_content_ancestor_unids.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-27T03:11:33.816Z","updated_at":"2025-12-27T03:17:44.585Z","closed_at":"2025-12-27T03:17:44.581Z","parent_id":"cell--tsysh-mjnq4vcg827","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnq4vcrhtk","title":"Investigate Table/Cell Failures (wc_1840, wc_1950, wc_1960)","description":"INVESTIGATION COMPLETE - CRITICAL: Missing accept_revisions() call before comparison! wc_1960 is a FALSE POSITIVE. The function exists in revision_accepter.rs but isn't used in compare().","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-27T03:11:33.819Z","updated_at":"2025-12-27T03:17:46.323Z","closed_at":"2025-12-27T03:17:46.318Z","parent_id":"cell--tsysh-mjnq4vcg827","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqd4a0u9d","title":"FIX: Add accept_revisions() before comparison in comparer.rs","description":"CRITICAL BUG - FALSE POSITIVE FIX\n\nC# WmlComparer.cs:255-256 calls AcceptRevisions() on both documents before comparison. Rust skips this step entirely, causing wc_1960 to report changes when documents are identical after revision acceptance.\n\nThe fix is simple - the function exists:\n- redline-rs/crates/redline-core/src/wml/revision_accepter.rs:47\n- Exported as accept_revisions in mod.rs\n\nIn comparer.rs:compare() around line 81-88, after preprocess_markup:\n1. Call accept_revisions() on both documents\n2. Get new body references\n3. Create atom lists from accepted documents\n\nExpected to fix: wc_1960 (false positive), likely wc_1840, wc_1950, and possibly others.","status":"closed","priority":0,"issue_type":"bug","created_at":"2025-12-27T03:17:58.632Z","updated_at":"2025-12-27T03:21:19.739Z","closed_at":"2025-12-27T03:21:19.739Z","parent_id":"cell--tsysh-mjnq4vcg827","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqd96sr3i","title":"FIX: Implement per-reference endnote comparison","description":"Refactor process_notes() to compare each endnote individually based on references in main document atoms.\n\nC# ProcessFootnoteEndnote (WmlComparer.cs:2885-3172):\n1. Collects footnote/endnote references from main document atoms (lines 2910-2914)\n2. For each reference ID, looks up corresponding endnote in both documents\n3. Runs LCS on that specific endnote only\n4. Handles inserted/deleted endnotes as complete units\n\nChanges needed in comparer.rs:\n1. After main document comparison, collect endnote reference IDs from atoms\n2. Pass these IDs to process_notes() \n3. Iterate per-ID, comparing individual endnotes\n4. Handle asymmetric cases (new/deleted endnotes)\n\nExpected to fix: wc_1710_endnotes3, wc_1720_endnotes_reverse","status":"open","priority":1,"issue_type":"bug","created_at":"2025-12-27T03:18:04.996Z","updated_at":"2025-12-27T03:18:04.996Z","parent_id":"cell--tsysh-mjnq4vcg827","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqde0lqfs","title":"FIX: Implement NormalizeTxbxContentAncestorUnids","description":"Port missing C# function NormalizeTxbxContentAncestorUnids (~230 lines).\n\nC# WmlComparer.cs:7571-7805 does:\n1. Groups atoms by txbxContent depth\n2. Subdivides into paragraph sub-groups\n3. Finds reference atoms (Equal/Deleted) for outer, paragraph, and run levels\n4. Normalizes UNIDs for mixed paragraphs\n\nAlso need to enhance assemble_ancestor_unids (comparer.rs:488-525):\n1. First normalize UNIDs for ALL atoms inside textboxes with Equal status\n2. Two-pass approach: non-textbox paragraphs first, then textbox content specifically\n\nExpected to fix: wc_1930_table_in_text_box2, wc_2090_textbox_before_ins, wc_2092_textbox_before_ins_reverse","status":"open","priority":1,"issue_type":"bug","created_at":"2025-12-27T03:18:11.253Z","updated_at":"2025-12-27T03:18:11.253Z","parent_id":"cell--tsysh-mjnq4vcg827","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnq4vcu6qi","title":"Investigate Image/Drawing Failures (wc_1260, wc_1450, wc_1940)","status":"in_progress","priority":2,"issue_type":"task","created_at":"2025-12-27T03:11:33.822Z","updated_at":"2025-12-27T03:26:25.219Z","parent_id":"cell--tsysh-mjnq4vcg827","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqqqeuzmd","title":"Map overall comparison pipeline flow","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-27T03:28:33.846Z","updated_at":"2025-12-27T03:28:33.846Z","parent_id":"cell--tsysh-mjnqqqectad","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqqqekp97","title":"Analyze ProcessFootnoteEndnote function","description":"Completed analysis of ProcessFootnoteEndnote function - found it handles footnote/endnote comparison using LCS algorithm, processes three correlation states (Equal, Inserted, Deleted), and ensures proper XML structure with reference elements.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T03:28:33.836Z","updated_at":"2025-12-27T03:28:58.907Z","closed_at":"2025-12-27T03:28:58.902Z","parent_id":"cell--tsysh-mjnqqqectad","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqqqenjy2","title":"Analyze NormalizeTxbxContentAncestorUnids function","description":"Completed analysis of NormalizeTxbxContentAncestorUnids function - found it normalizes unique IDs for textbox/VML content by grouping atoms inside txbxContent elements, subdividing into paragraph groups, and ensuring consistent ancestor unids for proper XML reconstruction, with special handling for mixed paragraphs containing both equal and inserted/deleted content.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T03:28:33.839Z","updated_at":"2025-12-27T03:29:00.839Z","closed_at":"2025-12-27T03:29:00.834Z","parent_id":"cell--tsysh-mjnqqqectad","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqqqepu1f","title":"Analyze revision acceptance workflow","description":"Completed analysis of revision acceptance workflow - found that AcceptRevisions is called twice in the comparison pipeline: first to accept revisions in source1 and reject in source2 for hash correlation, then again to accept revisions in both documents before final comparison. This ensures consistent baseline documents for comparison.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T03:28:33.841Z","updated_at":"2025-12-27T03:29:02.808Z","closed_at":"2025-12-27T03:29:02.804Z","parent_id":"cell--tsysh-mjnqqqectad","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqqqesj3a","title":"Analyze RevisionProcessor/RevisionAccepter","description":"Completed analysis of RevisionProcessor/RevisionAccepter - found RevisionProcessor.AcceptRevisions processes all document parts (main, headers, footers, footnotes, endnotes, styles) to merge tracked changes into the document content, ensuring a clean baseline for comparison.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T03:28:33.844Z","updated_at":"2025-12-27T03:29:04.875Z","closed_at":"2025-12-27T03:29:04.870Z","parent_id":"cell--tsysh-mjnqqqectad","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqrev28ls","title":"Complete Rust WML Comparer Implementation","description":"Address missing features in Rust WML comparer to achieve parity with C# implementation","status":"open","priority":1,"issue_type":"epic","created_at":"2025-12-27T03:29:05.534Z","updated_at":"2025-12-27T03:29:05.534Z","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqrev81s0","title":"Complete process_notes() function for footnote/endnote processing","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-27T03:29:05.540Z","updated_at":"2025-12-27T03:29:05.540Z","parent_id":"cell--tsysh-mjnqrev28ls","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqrevagwq","title":"Implement textbox handling in assemble_ancestor_unids()","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-27T03:29:05.542Z","updated_at":"2025-12-27T03:29:05.542Z","parent_id":"cell--tsysh-mjnqrev28ls","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqrevc6sj","title":"Implement NormalizedRPr and FormattingSignature computation","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-27T03:29:05.544Z","updated_at":"2025-12-27T03:29:05.544Z","parent_id":"cell--tsysh-mjnqrev28ls","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqreverlf","title":"Add NormalizeTxbxContentAncestorUnids function","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-27T03:29:05.546Z","updated_at":"2025-12-27T03:29:05.546Z","parent_id":"cell--tsysh-mjnqrev28ls","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqrevgigu","title":"Review and complete stubbed implementations","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-27T03:29:05.548Z","updated_at":"2025-12-27T03:29:05.548Z","parent_id":"cell--tsysh-mjnqrev28ls","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqqqectad","title":"Analyze C# WmlComparer Implementation for Rust Port","description":"Deep analysis of C# WmlComparer.cs focusing on endnotes/footnotes processing, textbox/VML handling, revision acceptance, and overall pipeline flow to identify architectural patterns for Rust implementation","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-27T03:28:33.828Z","updated_at":"2025-12-27T03:29:20.067Z","closed_at":"2025-12-27T03:29:20.067Z","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqqqez10j","title":"Search external GitHub examples","description":"Completed search for external GitHub examples - found multiple OpenXML PowerTools repositories using ProcessFootnoteEndnote and AcceptRevisions patterns, confirming these are established patterns in the OpenXML ecosystem. No external examples found for NormalizeTxbxContentAncestorUnids, suggesting it may be unique to this implementation.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T03:28:33.851Z","updated_at":"2025-12-27T03:29:09.132Z","closed_at":"2025-12-27T03:29:09.128Z","parent_id":"cell--tsysh-mjnqqqectad","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqqqf1l7t","title":"Review project history and docs","description":"Completed review of project history and docs - found extensive analysis in history/gap_analysis_DoLcsAlgorithm.md comparing C# WmlComparer.cs LCS implementation with Rust version, and OOXML_TRAVERSAL_BEST_PRACTICES.md documenting traversal patterns. No specific analysis of the three problem areas, but rich context on comparison architecture.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T03:28:33.853Z","updated_at":"2025-12-27T03:29:11.163Z","closed_at":"2025-12-27T03:29:11.157Z","parent_id":"cell--tsysh-mjnqqqectad","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqqqf38ms","title":"Synthesize findings and identify Rust gaps","description":"Completed synthesis of findings - key architectural patterns missing in Rust: 1) Dual revision processing (accept vs reject for correlation), 2) Complex footnote/endnote handling with LCS comparison, 3) VML/textbox content normalization with paragraph grouping, 4) Multi-level unid normalization for XML reconstruction, 5) Revision markup injection during reconstruction. These patterns require sophisticated XML manipulation and understanding of OpenXML revision semantics.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T03:28:33.855Z","updated_at":"2025-12-27T03:29:13.563Z","closed_at":"2025-12-27T03:29:13.556Z","parent_id":"cell--tsysh-mjnqqqectad","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqsl6vvjo","title":"Performance Model Analysis: Char-level Hierarchical LCS vs Word-level Flat LCS","description":"Develop comprehensive performance model comparing char-level hierarchical LCS vs word-level flat LCS with thresholds, including expected n, recursion fanout, cache behavior, worst-case triggers, and scaling recommendations for 100+ pages.","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-27T03:30:00.391Z","updated_at":"2025-12-27T03:30:26.735Z","closed_at":"2025-12-27T03:30:26.735Z","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqsl72a24","title":"Analyze current LCS implementation structure","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-27T03:30:00.398Z","updated_at":"2025-12-27T03:30:04.329Z","closed_at":"2025-12-27T03:30:04.329Z","parent_id":"cell--tsysh-mjnqsl6vvjo","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqsl74kfy","title":"Model expected input sizes (n) for different document types","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-27T03:30:00.400Z","updated_at":"2025-12-27T03:30:09.072Z","closed_at":"2025-12-27T03:30:09.072Z","parent_id":"cell--tsysh-mjnqsl6vvjo","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqsl76ae1","title":"Calculate recursion fanout patterns","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T03:30:00.402Z","updated_at":"2025-12-27T03:30:12.970Z","closed_at":"2025-12-27T03:30:12.970Z","parent_id":"cell--tsysh-mjnqsl6vvjo","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqsl788p1","title":"Analyze cache behavior and memory patterns","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T03:30:00.404Z","updated_at":"2025-12-27T03:30:17.247Z","closed_at":"2025-12-27T03:30:17.247Z","parent_id":"cell--tsysh-mjnqsl6vvjo","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqsl793jc","title":"Identify worst-case triggers and pathological inputs","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-27T03:30:00.405Z","updated_at":"2025-12-27T03:30:21.148Z","closed_at":"2025-12-27T03:30:21.148Z","parent_id":"cell--tsysh-mjnqsl6vvjo","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqsl7c85w","title":"Develop scaling recommendations for 100+ pages","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-27T03:30:00.408Z","updated_at":"2025-12-27T03:30:25.116Z","closed_at":"2025-12-27T03:30:25.116Z","parent_id":"cell--tsysh-mjnqsl6vvjo","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqwk9d7eh","title":"Golden File Nondeterminism Analysis","description":"Analyze golden file generation/usage patterns in multi-language ports (C#, Rust, TS) and identify sources of nondeterministic outputs","status":"open","priority":1,"issue_type":"epic","created_at":"2025-12-27T03:33:05.809Z","updated_at":"2025-12-27T03:33:05.809Z","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqwk9o5q8","title":"Examine TestFiles Structure and Usage","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-27T03:33:05.820Z","updated_at":"2025-12-27T03:33:05.820Z","parent_id":"cell--tsysh-mjnqwk9d7eh","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqwk9q1ei","title":"Compare C# vs Rust/TS Golden File Handling","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-27T03:33:05.822Z","updated_at":"2025-12-27T03:33:05.822Z","parent_id":"cell--tsysh-mjnqwk9d7eh","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqwk9sfwx","title":"Research Golden File Testing Best Practices","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-27T03:33:05.824Z","updated_at":"2025-12-27T03:33:05.824Z","parent_id":"cell--tsysh-mjnqwk9d7eh","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqwk9unq9","title":"Investigate Multi-Language Porting Challenges","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-27T03:33:05.826Z","updated_at":"2025-12-27T03:33:05.826Z","parent_id":"cell--tsysh-mjnqwk9d7eh","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqwk9ws0r","title":"Analyze File System and Locale Nondeterminism","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-27T03:33:05.828Z","updated_at":"2025-12-27T03:33:05.828Z","parent_id":"cell--tsysh-mjnqwk9d7eh","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqwk9ymyi","title":"Analyze Path, Zip, and Timestamp Issues","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-27T03:33:05.830Z","updated_at":"2025-12-27T03:33:05.830Z","parent_id":"cell--tsysh-mjnqwk9d7eh","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqwka2g2n","title":"Synthesize Findings and Create Classification Checklist","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-27T03:33:05.834Z","updated_at":"2025-12-27T03:33:05.834Z","parent_id":"cell--tsysh-mjnqwk9d7eh","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqwrcqfd9","title":"Analysis of False Test Failures in Docker/CI Environments","description":"Comprehensive analysis of how Docker, xUnit filters, and CI env vars cause false test failures, with diagnostics and mitigations","status":"open","priority":1,"issue_type":"epic","created_at":"2025-12-27T03:33:15.002Z","updated_at":"2025-12-27T03:33:15.002Z","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqwrcwof0","title":"Research Docker volume mount issues","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-27T03:33:15.008Z","updated_at":"2025-12-27T03:33:15.008Z","parent_id":"cell--tsysh-mjnqwrcqfd9","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqwrcyuge","title":"Research timezone-related test failures","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-27T03:33:15.010Z","updated_at":"2025-12-27T03:33:15.010Z","parent_id":"cell--tsysh-mjnqwrcqfd9","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqwrd0bwg","title":"Research permission issues in Docker tests","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-27T03:33:15.012Z","updated_at":"2025-12-27T03:33:15.012Z","parent_id":"cell--tsysh-mjnqwrcqfd9","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqwrd23wc","title":"Research path resolution issues","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-27T03:33:15.014Z","updated_at":"2025-12-27T03:33:15.014Z","parent_id":"cell--tsysh-mjnqwrcqfd9","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqwrd4hnk","title":"Research xUnit filter false positives","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-27T03:33:15.016Z","updated_at":"2025-12-27T03:33:15.016Z","parent_id":"cell--tsysh-mjnqwrcqfd9","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqwrd6euc","title":"Research CI environment variable issues","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-27T03:33:15.018Z","updated_at":"2025-12-27T03:33:15.018Z","parent_id":"cell--tsysh-mjnqwrcqfd9","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqwrd83f6","title":"Examine local test configurations","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-27T03:33:15.020Z","updated_at":"2025-12-27T03:33:15.020Z","parent_id":"cell--tsysh-mjnqwrcqfd9","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqwrda0xj","title":"Synthesize analysis and provide mitigations","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-27T03:33:15.022Z","updated_at":"2025-12-27T03:33:15.022Z","parent_id":"cell--tsysh-mjnqwrcqfd9","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqwk9l9g6","title":"Analyze GoldenFileGenerator Codebase","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T03:33:05.817Z","updated_at":"2025-12-27T03:33:23.199Z","closed_at":"2025-12-27T03:33:23.199Z","parent_id":"cell--tsysh-mjnqwk9d7eh","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqzn6mbjm","title":"Fix OpenXML Part Model Contract Violations","description":"Address systematic violations in preprocess/atomize/LCS/coalesce pipeline where part boundaries, relationship scope, and original-to-processed mappings are lost, breaking coalescing and revision insertion.","status":"open","priority":1,"issue_type":"epic","created_at":"2025-12-27T03:35:29.566Z","updated_at":"2025-12-27T03:35:29.566Z","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqzn6vkir","title":"Implement relationship-aware part discovery","status":"open","priority":0,"issue_type":"task","created_at":"2025-12-27T03:35:29.575Z","updated_at":"2025-12-27T03:35:29.575Z","parent_id":"cell--tsysh-mjnqzn6mbjm","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqzn6zfit","title":"Add part boundary isolation in atomization","status":"open","priority":0,"issue_type":"task","created_at":"2025-12-27T03:35:29.579Z","updated_at":"2025-12-27T03:35:29.579Z","parent_id":"cell--tsysh-mjnqzn6mbjm","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqzn72r6f","title":"Preserve part context through LCS pipeline","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-27T03:35:29.582Z","updated_at":"2025-12-27T03:35:29.582Z","parent_id":"cell--tsysh-mjnqzn6mbjm","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqzn75l20","title":"Implement part-aware coalescing","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-27T03:35:29.585Z","updated_at":"2025-12-27T03:35:29.585Z","parent_id":"cell--tsysh-mjnqzn6mbjm","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqzn79dvr","title":"Add header/footer/comments part processing","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-27T03:35:29.589Z","updated_at":"2025-12-27T03:35:29.589Z","parent_id":"cell--tsysh-mjnqzn6mbjm","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqzxlu8mq","title":"Performance Analysis: LINQ/XElement Diff Porting Pitfalls to Rust","description":"Deep analysis of performance pitfalls when porting LINQ/XElement document diff algorithms to Rust, with recommendations for data structures and architectural decisions affecting WmlComparer-style comparison performance.","status":"open","priority":1,"issue_type":"epic","created_at":"2025-12-27T03:35:43.074Z","updated_at":"2025-12-27T03:35:43.074Z","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqzzpnz6c","title":"Complete WmlComparer Test Coverage Analysis and Gap Resolution","description":"Analyze current Rust WmlComparer test coverage, identify missing scenarios, and resolve implementation gaps to achieve full compatibility with C# reference implementation.","status":"open","priority":1,"issue_type":"epic","created_at":"2025-12-27T03:35:45.803Z","updated_at":"2025-12-27T03:35:45.803Z","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqzzpt58d","title":"Fix compilation errors in comparer.rs","status":"open","priority":0,"issue_type":"task","created_at":"2025-12-27T03:35:45.809Z","updated_at":"2025-12-27T03:35:45.809Z","parent_id":"cell--tsysh-mjnqzzpnz6c","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqzzpx32o","title":"Implement per-reference footnote/endnote comparison","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-27T03:35:45.813Z","updated_at":"2025-12-27T03:35:45.813Z","parent_id":"cell--tsysh-mjnqzzpnz6c","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqzzpzhxc","title":"Add NormalizeTxbxContentAncestorUnids function","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-27T03:35:45.815Z","updated_at":"2025-12-27T03:35:45.815Z","parent_id":"cell--tsysh-mjnqzzpnz6c","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqzzq1mlw","title":"Implement merged cell detection logic","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-27T03:35:45.817Z","updated_at":"2025-12-27T03:35:45.817Z","parent_id":"cell--tsysh-mjnqzzpnz6c","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqzzq38v8","title":"Add missing LCS algorithm edge cases","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-27T03:35:45.819Z","updated_at":"2025-12-27T03:35:45.819Z","parent_id":"cell--tsysh-mjnqzzpnz6c","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqzzq55od","title":"Implement NormalizedRPr computation","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-27T03:35:45.821Z","updated_at":"2025-12-27T03:35:45.821Z","parent_id":"cell--tsysh-mjnqzzpnz6c","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqzzq7na9","title":"Add tests for complex nested scenarios","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-27T03:35:45.823Z","updated_at":"2025-12-27T03:35:45.823Z","parent_id":"cell--tsysh-mjnqzzpnz6c","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqzxm0xp9","title":"Analyze C# WmlComparer Implementation","description":"Examine the current C# WmlComparer implementation to understand LINQ/XElement usage patterns, diff algorithms, and performance characteristics. Focus on tree navigation, hashing, and comparison logic.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T03:35:43.080Z","updated_at":"2025-12-27T03:36:08.829Z","closed_at":"2025-12-27T03:36:08.829Z","parent_id":"cell--tsysh-mjnqzxlu8mq","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqzxm29it","title":"Analyze Existing Rust Port Structure","description":"Review the current Rust port (redline-rs) to understand what's already implemented, data structures used, and any existing performance patterns or issues.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T03:35:43.082Z","updated_at":"2025-12-27T03:36:09.961Z","closed_at":"2025-12-27T03:36:09.961Z","parent_id":"cell--tsysh-mjnqzxlu8mq","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqzxm4u5s","title":"Analyze LINQ/XElement Usage Patterns","description":"Search the codebase for LINQ and XElement usage patterns, especially in document comparison logic. Identify common operations that may have performance implications in Rust.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T03:35:43.084Z","updated_at":"2025-12-27T03:36:10.699Z","closed_at":"2025-12-27T03:36:10.699Z","parent_id":"cell--tsysh-mjnqzxlu8mq","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqzxm6wug","title":"Research Rust XML Libraries Performance","description":"Investigate performance characteristics of popular Rust XML libraries (xml-rs, quick-xml, roxmltree) for parsing, navigation, and manipulation operations.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T03:35:43.086Z","updated_at":"2025-12-27T03:36:12.085Z","closed_at":"2025-12-27T03:36:12.085Z","parent_id":"cell--tsysh-mjnqzxlu8mq","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqzxm74ld","title":"Research Tree Diffing Best Practices in Rust","description":"Find best practices and patterns for implementing efficient tree diffing algorithms in Rust, focusing on memory management and computational complexity.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T03:35:43.087Z","updated_at":"2025-12-27T03:36:13.290Z","closed_at":"2025-12-27T03:36:13.290Z","parent_id":"cell--tsysh-mjnqzxlu8mq","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqzxm9okn","title":"Find High-Performance Diff Algorithm Examples","description":"Search for examples of high-performance diff algorithms in Rust, particularly for tree structures and document comparison.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T03:35:43.089Z","updated_at":"2025-12-27T03:36:13.800Z","closed_at":"2025-12-27T03:36:13.800Z","parent_id":"cell--tsysh-mjnqzxlu8mq","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqzxmaa24","title":"Compare C# LINQ vs Rust Iterator Patterns","description":"Analyze performance differences between C# LINQ operations and equivalent Rust iterator patterns, especially for lazy evaluation and memory usage.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T03:35:43.090Z","updated_at":"2025-12-27T03:36:14.347Z","closed_at":"2025-12-27T03:36:14.347Z","parent_id":"cell--tsysh-mjnqzxlu8mq","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqzxmc2sg","title":"Analyze Memory Management Differences C# vs Rust","description":"Compare garbage collection vs ownership/borrowing models and their impact on allocation patterns, cloning, and performance in diff algorithms.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T03:35:43.092Z","updated_at":"2025-12-27T03:36:14.865Z","closed_at":"2025-12-27T03:36:14.865Z","parent_id":"cell--tsysh-mjnqzxlu8mq","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqzxmelba","title":"Architecture Oracle: Data Structure Choices for XML Trees","description":"Provide expert analysis on optimal Rust data structures for representing and navigating XML document trees in diff operations. Depends on all Phase 1 research.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-27T03:35:43.094Z","updated_at":"2025-12-27T03:36:21.625Z","closed_at":"2025-12-27T03:36:21.625Z","parent_id":"cell--tsysh-mjnqzxlu8mq","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqzxmg078","title":"Performance Oracle: Allocation/Cloning Pitfalls","description":"Analyze common allocation and cloning pitfalls when porting from LINQ/XElement to Rust, with specific recommendations for WmlComparer-style comparisons. Depends on all Phase 1 research.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-27T03:35:43.096Z","updated_at":"2025-12-27T03:36:22.837Z","closed_at":"2025-12-27T03:36:22.837Z","parent_id":"cell--tsysh-mjnqzxlu8mq","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqzxmib1h","title":"Edge Cases Oracle: Complex Document Structures","description":"Analyze performance implications of complex document structures and edge cases in diff algorithms, with Rust-specific recommendations. Depends on all Phase 1 research.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-27T03:35:43.098Z","updated_at":"2025-12-27T03:36:24.141Z","closed_at":"2025-12-27T03:36:24.141Z","parent_id":"cell--tsysh-mjnqzxlu8mq","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqzxmj26b","title":"Synthesize Findings and Recommendations","description":"Cross-reference all findings, identify consensus and contradictions, and provide comprehensive recommendations for Rust data structures and architectural decisions. Depends on all oracle analyses.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-27T03:35:43.099Z","updated_at":"2025-12-27T03:36:29.753Z","closed_at":"2025-12-27T03:36:29.753Z","parent_id":"cell--tsysh-mjnqzxlu8mq","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnr3bd11vx","title":"Formal Verification Framework for OOXML Comparison","description":"Implement comprehensive formal verification and testing framework for OOXML comparison algorithms including invariants, property-based tests, metamorphic relations, and differential testing against C# reference implementation.","status":"open","priority":1,"issue_type":"epic","created_at":"2025-12-27T03:38:20.869Z","updated_at":"2025-12-27T03:38:20.869Z","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnqwka09e7","title":"Expert Consultation: Architecture and Edge Cases","description":"Blocked: reserved file `history/architecture_edge_cases.md` does not exist and current toolset lacks write/edit operations; sent full proposed contents to coordinator via Swarm Mail for creation/paste.","status":"blocked","priority":2,"issue_type":"task","created_at":"2025-12-27T03:33:05.832Z","updated_at":"2025-12-27T03:50:44.020Z","parent_id":"cell--tsysh-mjnqwk9d7eh","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnr3bd7rmj","title":"Define Core Invariants for OOXML Comparison","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-27T03:38:20.875Z","updated_at":"2025-12-27T03:39:00.262Z","closed_at":"2025-12-27T03:39:00.262Z","parent_id":"cell--tsysh-mjnr3bd11vx","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnr3bda72r","title":"Implement Property-Based Test Suite","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-27T03:38:20.878Z","updated_at":"2025-12-27T03:39:08.235Z","closed_at":"2025-12-27T03:39:08.235Z","parent_id":"cell--tsysh-mjnr3bd11vx","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnr3bdcqcl","title":"Add Metamorphic Relations Testing","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-27T03:38:20.880Z","updated_at":"2025-12-27T03:39:12.668Z","closed_at":"2025-12-27T03:39:12.668Z","parent_id":"cell--tsysh-mjnr3bd11vx","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnr3bddqdy","title":"Build Oracle-Based Differential Testing Framework","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T03:38:20.881Z","updated_at":"2025-12-27T03:39:04.317Z","closed_at":"2025-12-27T03:39:04.317Z","parent_id":"cell--tsysh-mjnr3bd11vx","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnr3bdf1n2","title":"Complete SmlComparer Implementation","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-27T03:38:20.883Z","updated_at":"2025-12-27T03:39:18.390Z","closed_at":"2025-12-27T03:39:18.390Z","parent_id":"cell--tsysh-mjnr3bd11vx","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjod7w3mal9","title":"Fix WmlComparer Architectural Gaps (Image/Drawing, Revision Counting, French Locale)","description":"**Status**: ðŸ”´ BLOCKING - 15 tests failing (89/104 passing)\n\n**Root Cause Analysis** (from DEEP_ANALYSIS_WML_COMPARER_FAILURES.md):\nThese failures are symptoms of incomplete architectural layers, not isolated bugs.\n\n**Three Failure Categories**:\n1. Image/Drawing (wc_1260, wc_1450, wc_1940) - Missing consolidation pipeline\n2. Revision Counting (wc_1180, wc_2040) - Missing similarity thresholds + formatting tracking\n3. French Locale (wc_1970, wc_1980) - Missing locale abstraction in TypeScript\n\n**Architecture-First Approach**:\nFix the underlying pipeline gaps rather than patching individual tests.\n\n**Estimated Total Effort**: 7-9 days\n**Expected Outcome**: All 104 WML comparer tests passing","status":"open","priority":1,"issue_type":"epic","created_at":"2025-12-27T13:57:45.922Z","updated_at":"2025-12-27T13:57:45.922Z","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjod7w3s7km","title":"RUST-1: Define Canonical Atom Model (Foundation)","description":"**FOUNDATION TASK - No Dependencies, Blocks: RUST-2, RUST-3, RUST-4**\n\n**Goal**: Define a unified canonical atom model that all comparison/counting stages consume.\n\n**Current Problem**:\n- Atoms don't have a consistent identity scheme\n- Non-text elements (drawings) use different representation than text\n- No stable canonical form for equality comparison\n\n**Implementation Requirements**:\n1. Define `CanonicalAtom` trait/struct with:\n   - `identity_hash()` â†’ stable SHA1 of canonical representation\n   - `content_type()` â†’ Text | Drawing | Field | ParagraphMark | etc.\n   - `formatting_signature()` â†’ hash of normalized rPr\n   - `ancestor_unids()` â†’ for tree reconstruction\n\n2. Ensure drawings participate in same scheme as text atoms\n3. Add `impl PartialEq` based on identity_hash, not structural equality\n\n**C# Reference**: WmlComparer.cs lines 8157-8596 (ComparisonUnitAtom class)\n\n**Files**:\n- redline-rs/crates/redline-core/src/wml/comparison_unit.rs\n- redline-rs/crates/redline-core/src/wml/atom_list.rs\n\n**Effort**: 0.5 days\n**Tests Expected to Improve**: Foundation for all 15 failing tests","status":"open","priority":0,"issue_type":"task","created_at":"2025-12-27T13:57:45.928Z","updated_at":"2025-12-27T13:58:06.627Z","parent_id":"cell--tsysh-mjod7w3mal9","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjod7w3ukxb","title":"RUST-2: Implement CoalesceAdjacentRunsWithIdenticalFormatting","description":"**CRITICAL - Depends on: RUST-1 | Blocks: RUST-5, RUST-6**\n\n**Goal**: Port the missing consolidation step that merges adjacent runs with identical formatting.\n\n**Current Problem**:\n- Adjacent revisions with identical formatting remain as separate w:ins/w:del elements\n- Revision counts are inflated (e.g., 2 revisions instead of 1)\n- Image comparisons fail because adjacent formatting changes aren't merged\n\n**Implementation Requirements**:\n1. Port C# `CoalesceAdjacentRunsWithIdenticalFormatting` (WmlComparer.cs:2174+)\n2. Grouping key must include:\n   - CorrelationStatus (don't merge across status boundaries)\n   - FormattingSignature (format change boundaries)\n   - Author + Date (revision metadata)\n3. Apply AFTER markup generation, BEFORE final XML output\n\n**C# Reference**: WmlComparer.cs lines 2174-2300\n\n**Algorithm**:\n```\nfor each run in document:\n  if run.formatting_key == previous.formatting_key:\n    merge into previous\n  else:\n    start new group\n```\n\n**Files**:\n- redline-rs/crates/redline-core/src/wml/coalesce.rs\n- OpenXmlPowerTools/WmlComparer.cs (reference)\n\n**Effort**: 1.5 days\n**Tests Expected to Fix**: wc_1260, wc_1450, wc_1940 (image/drawing failures)","status":"open","priority":0,"issue_type":"task","created_at":"2025-12-27T13:57:45.930Z","updated_at":"2025-12-27T13:58:13.859Z","parent_id":"cell--tsysh-mjod7w3mal9","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjod7w3wvee","title":"RUST-3: Add Drawing Canonical Identity (SHA1 Hash Pipeline)","description":"**CRITICAL - Depends on: RUST-1 | Blocks: RUST-2**\n\n**Goal**: Ensure drawings have stable canonical identity via SHA1 hash of content.\n\n**Current Problem**:\n- Relationship IDs (rId5, rId6) change across saves even if image is identical\n- Current implementation may compare structural XML instead of content\n- Leads to false positives (same image detected as different)\n\n**Implementation Requirements**:\n1. For `w:drawing` and `w:pict` elements:\n   - Extract `r:embed` or `r:link` from `a:blip`\n   - Resolve to ImagePart via relationship\n   - Hash binary stream (SHA1)\n   - Store hash as canonical identity\n\n2. Handle both DrawingML (`w:drawing`) and VML (`w:pict`)\n3. Handle textbox content (`w:txbxContent`) specially - recurse into content\n4. Gracefully handle missing relationships (sentinel value)\n\n**C# Reference**: \n- WmlComparer.cs lines 4340-4350 (drawing/pict handling)\n- PmlComparer.cs lines 1022-1041 (ExtractImageHash pattern)\n\n**Algorithm**:\n```rust\nfn compute_drawing_identity(element: &XmlElement, part: &OpenXmlPart) -> String {\n    let blip = element.descendants(A_BLIP).first()?;\n    let embed_id = blip.attribute(R_EMBED)?;\n    let image_part = part.get_part_by_id(embed_id)?;\n    sha1_hash(image_part.get_stream())\n}\n```\n\n**Files**:\n- redline-rs/crates/redline-core/src/wml/comparison_unit.rs\n- redline-rs/crates/redline-core/src/wml/atom_list.rs\n\n**Effort**: 1 day\n**Tests Expected to Fix**: wc_1260, wc_1450 (image comparison failures)","status":"open","priority":0,"issue_type":"task","created_at":"2025-12-27T13:57:45.932Z","updated_at":"2025-12-27T13:58:22.551Z","parent_id":"cell--tsysh-mjod7w3mal9","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjod7w3yphj","title":"RUST-4: Implement Explicit ChangeEvent Model with FormatChange","description":"**HIGH PRIORITY - Depends on: RUST-1 | Blocks: RUST-5, RUST-6**\n\n**Goal**: Make the diff output explicit ChangeEvents instead of just correlation status.\n\n**Current Problem**:\n- Rust ignores `ComparisonCorrelationStatus::FormatChanged` in counting loop\n- wc_2040 fails because formatting-only changes (rPrChange) aren't counted\n- No unified event model for downstream grouping/counting\n\n**Implementation Requirements**:\n1. Define `ChangeEvent` enum:\n   ```rust\n   enum ChangeEvent {\n       Insert { atoms: Vec<Atom>, author: String, date: String },\n       Delete { atoms: Vec<Atom>, author: String, date: String },\n       Replace { old: Vec<Atom>, new: Vec<Atom>, ... },\n       FormatChange { atom: Atom, before_rPr: RProps, after_rPr: RProps, ... },\n   }\n   ```\n\n2. After LCS correlation, emit ChangeEvents (not just mark atoms)\n3. FormatChange emitted when:\n   - ContentSignature matches but FormattingSignature differs\n   - Corresponds to w:rPrChange in output XML\n\n**C# Reference**:\n- WmlComparer.cs lines 3985+ (GetFormattingRevisionList)\n- WmlComparer.cs lines 8300-8345 (FormattingChangeRPrBefore handling)\n\n**Files**:\n- redline-rs/crates/redline-core/src/wml/comparer.rs (new module: change_event.rs)\n\n**Effort**: 1 day\n**Tests Expected to Fix**: wc_2040 (character style / formatting change)","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-27T13:57:45.934Z","updated_at":"2025-12-27T13:58:30.675Z","parent_id":"cell--tsysh-mjod7w3mal9","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjod7w40jyq","title":"RUST-5: Implement Similarity Threshold Classification (0.4/0.5)","description":"**HIGH PRIORITY - Depends on: RUST-2, RUST-4 | Blocks: RUST-6**\n\n**Goal**: Implement similarity thresholds to distinguish \"replacement\" from \"modification\".\n\n**Current Problem**:\n- wc_1180: Rust incorrectly splits paragraph modification into 2 revisions (1 ins + 1 del)\n- Should recognize as single \"modification\" when content is similar enough\n- C# uses 0.4/0.5 similarity thresholds\n\n**Implementation Requirements**:\n1. After LCS alignment, for paired (old, new) content:\n   ```rust\n   let similarity = lcs_length as f64 / max(old.len(), new.len()) as f64;\n   if similarity >= 0.5 {\n       emit ChangeEvent::Modify  // Single revision\n   } else {\n       emit ChangeEvent::Delete + ChangeEvent::Insert  // Two revisions\n   }\n   ```\n\n2. Apply at word level (not character level)\n3. Threshold values from C#:\n   - 0.5 for \"modification\" classification\n   - 0.4 for \"related content\" detection\n   - DetailThreshold 0.15 for discarding weak matches\n\n**C# Reference**:\n- WmlComparer.cs DetailThreshold = 0.15\n- redline-js/src/wml/wml-comparer.ts lines 1496+ (countWordRevisions with 0.4/0.5)\n\n**Files**:\n- redline-rs/crates/redline-core/src/wml/comparer.rs\n- redline-rs/crates/redline-core/src/wml/lcs.rs\n\n**Effort**: 1.5 days\n**Tests Expected to Fix**: wc_1180 (deleted at beginning of paragraph)","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-27T13:57:45.936Z","updated_at":"2025-12-27T13:58:37.686Z","parent_id":"cell--tsysh-mjod7w3mal9","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjod7w42uu9","title":"RUST-6: Add GroupAdjacent Logic for Revision Counting","description":"**HIGH PRIORITY - Depends on: RUST-4, RUST-5**\n\n**Goal**: Implement GroupAdjacent logic matching C# exactly for revision counting.\n\n**Current Problem**:\n- Revision counting is naive - counts each atom status separately\n- Should group adjacent changes with same (author, date, type) as ONE revision\n- Missing the aggregation step that produces final revision count\n\n**Implementation Requirements**:\n1. Port C# `GroupAdjacent` pattern (WmlComparer.cs:3909):\n   ```rust\n   fn group_adjacent<T, K>(items: Vec<T>, key_fn: impl Fn(&T) -> K) -> Vec<Vec<T>>\n   where K: PartialEq\n   ```\n\n2. Grouping key for revisions:\n   - CorrelationStatus (Insert/Delete/FormatChange)\n   - Author string\n   - DateTime (with appropriate rounding)\n   - Revision type\n\n3. Count = number of groups, not number of atoms\n\n**C# Reference**:\n- WmlComparer.cs line 3909 (GroupAdjacent)\n- WmlComparer.cs lines 3887-3960 (GetRevisions)\n\n**Algorithm**:\n```rust\nlet groups = group_adjacent(change_events, |e| (e.status, e.author, e.date));\nlet revision_count = groups.len();\n```\n\n**Files**:\n- redline-rs/crates/redline-core/src/wml/comparer.rs\n\n**Effort**: 1 day\n**Tests Expected to Fix**: Multiple revision counting edge cases","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-27T13:57:45.938Z","updated_at":"2025-12-27T13:58:44.160Z","parent_id":"cell--tsysh-mjod7w3mal9","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjod7w44qbw","title":"TS-1: Create LocaleProvider Abstraction","description":"**INDEPENDENT TRACK (TypeScript) - No Rust Dependencies | Blocks: TS-2**\n\n**Goal**: Create a LocaleProvider abstraction for pluggable locale-specific formatting.\n\n**Current Problem**:\n- List item text generation is hardcoded or missing\n- No clean way to add new locales\n- French documents fall back to English numbering\n\n**Implementation Requirements**:\n1. Define `LocaleProvider` interface:\n   ```typescript\n   interface LocaleProvider {\n     getCardinalText(n: number, gender?: string): string | null;\n     getOrdinalText(n: number, gender?: string): string | null;\n     getListItemText(levelNumber: number, numFmt: string): string | null;\n   }\n   ```\n\n2. Create registry with fallback chain:\n   ```typescript\n   const localeRegistry: Map<string, LocaleProvider> = new Map();\n   \n   function getProvider(locale: string): LocaleProvider {\n     return localeRegistry.get(locale) \n         ?? localeRegistry.get(locale.split('-')[0])\n         ?? defaultProvider;\n   }\n   ```\n\n3. Port `ListItemRetriever.cs` locale routing dictionary\n\n**C# Reference**:\n- ListItemRetriever.cs (locale mapping dictionary)\n- GetListItemText_Default.cs (default implementation)\n\n**Files**:\n- redline-js/src/wml/locale.ts (new file)\n- redline-js/src/wml/locale-default.ts (new file)\n\n**Effort**: 0.5 days\n**Tests Expected to Fix**: Foundation for wc_1970, wc_1980","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-27T13:57:45.940Z","updated_at":"2025-12-27T13:58:51.064Z","parent_id":"cell--tsysh-mjod7w3mal9","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjod7w45zf8","title":"TS-2: Port GetListItemText_fr_FR to TypeScript","description":"**INDEPENDENT TRACK (TypeScript) - Depends on: TS-1**\n\n**Goal**: Port French list item text generation from C# to TypeScript.\n\n**Current Problem**:\n- wc_1970, wc_1980 fail because French numbering produces English output\n- Missing: cardinal (\"un\", \"deux\", \"trois\") and ordinal (\"premier\", \"deuxiÃ¨me\")\n- Missing: Complex French rules (soixante-dix, quatre-vingts)\n\n**Implementation Requirements**:\n1. Port arrays from GetListItemText_fr_FR.cs:\n   ```typescript\n   const ones = [\"\", \"un\", \"deux\", \"trois\", \"quatre\", \"cinq\", ...];\n   const tens = [\"\", \"dix\", \"vingt\", \"trente\", \"quarante\", ...];\n   const ordinalSuffixes = [\"er\", \"e\", \"e\", ...];\n   ```\n\n2. Handle French-specific rules:\n   - 70-79: \"soixante-dix\", \"soixante-et-onze\", etc.\n   - 80: \"quatre-vingts\" (with 's')\n   - 81-99: \"quatre-vingt-un\" (no 's'), \"quatre-vingt-dix\", etc.\n   - \"et\" connector for 21, 31, 41, 51, 61, 71\n\n3. Implement both `getCardinalText` and `getOrdinalText`:\n   - Cardinal: \"un\", \"deux\", \"trois\"...\n   - Ordinal: \"premier\", \"deuxiÃ¨me\", \"troisiÃ¨me\"...\n\n**C# Reference**:\n- OpenXmlPowerTools/GetListItemText_fr_FR.cs (full implementation)\n\n**Edge Cases**:\n- 1 ordinal = \"premier\" (not \"uniÃ¨me\")\n- 80 = \"quatre-vingts\" but 81 = \"quatre-vingt-un\"\n- Return null for unsupported numFmt (match C# behavior)\n\n**Files**:\n- redline-js/src/wml/locale-fr-FR.ts (new file)\n- OpenXmlPowerTools/GetListItemText_fr_FR.cs (reference)\n\n**Effort**: 1 day\n**Tests Expected to Fix**: wc_1970, wc_1980 (French locale failures)","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-27T13:57:45.941Z","updated_at":"2025-12-27T13:58:58.512Z","parent_id":"cell--tsysh-mjod7w3mal9","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjod9ttasfs","title":"VERIFY-1: Build Differential Testing Framework (C# Oracle)","description":"**VERIFICATION TRACK - Independent, can start immediately**\n\n**Goal**: Create automated differential testing using C# as the oracle.\n\n**Implementation Requirements**:\n1. Test harness that runs same input through both C# and Rust/TS\n2. Compare normalized outputs:\n   - Revision counts per category (insert, delete, format)\n   - Grouped revision records (group key + size)\n   - Detected images (count + hashes)\n3. Report mismatches with detailed diff\n\n**Script Structure**:\n```bash\n#!/bin/bash\n# For each test case:\ndotnet run --project GoldenFileGenerator -- compare $INPUT1 $INPUT2 > csharp_result.json\ncargo run --bin compare -- $INPUT1 $INPUT2 > rust_result.json\ndiff csharp_result.json rust_result.json\n```\n\n**Files**:\n- scripts/differential-test.sh (new)\n- GoldenFileGenerator/Program.cs (add JSON output mode)\n\n**Effort**: 1 day\n**Benefit**: Catch regressions early, validate each fix against ground truth","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-27T13:59:16.270Z","updated_at":"2025-12-27T13:59:16.270Z","parent_id":"cell--tsysh-mjod7w3mal9","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjoda0bdyoo","title":"VERIFY-2: Create Edge Case Test Suite","description":"**VERIFICATION TRACK - Depends on: VERIFY-1**\n\n**Goal**: Create targeted test documents for edge cases identified in analysis.\n\n**Test Cases Needed**:\n\n**Image/Drawing Edge Cases**:\n- Document with 100+ images (performance)\n- Mixed w:drawing and w:pict (VML compatibility)\n- Images with broken relationships (graceful degradation)\n- Images in textboxes (w:txbxContent)\n\n**Revision Counting Edge Cases**:\n- Deletion at paragraph start (wc_1180 pattern)\n- Pure formatting change (wc_2040 pattern)\n- Mixed content + format change\n- Adjacent changes by same author\n- Adjacent changes by different authors\n\n**French Locale Edge Cases**:\n- Numbers 70, 71, 80, 81, 90, 91 (rule boundaries)\n- Ordinal \"premier\" vs \"deuxiÃ¨me\"\n- cardinalText vs ordinalText numFmt\n- Mixed French/English document\n\n**Files**:\n- TestFiles/WC/edge-cases/ (new directory)\n- redline-rs/tests/edge_cases.rs (new)\n\n**Effort**: 1-2 days\n**Benefit**: Comprehensive coverage of identified failure modes","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-27T13:59:24.697Z","updated_at":"2025-12-27T13:59:24.697Z","parent_id":"cell--tsysh-mjod7w3mal9","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjndvw6a7rr","title":"Verify and Close C# Parity Gaps in LCS Algorithm","description":"Comprehensive verification of C# WmlComparer LCS algorithm parity with Rust port, identifying and closing all implementation gaps","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-26T21:28:39.586Z","updated_at":"2025-12-27T14:06:48.109Z","closed_at":"2025-12-27T14:06:48.109Z","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjndvw6hsq6","title":"Detailed gap analysis: Compare C# vs Rust line-by-line for FindCommonAtBeginningAndEnd","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-26T21:28:39.593Z","updated_at":"2025-12-27T14:06:37.321Z","closed_at":"2025-12-27T14:06:37.321Z","parent_id":"cell--tsysh-mjndvw6a7rr","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjndvw6k6mz","title":"Detailed gap analysis: Compare C# vs Rust line-by-line for DoLcsAlgorithm","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-26T21:28:39.596Z","updated_at":"2025-12-27T14:06:39.220Z","closed_at":"2025-12-27T14:06:39.220Z","parent_id":"cell--tsysh-mjndvw6a7rr","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjndvw6nvuy","title":"Detailed gap analysis: Compare C# vs Rust for DoLcsAlgorithmForTable","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-26T21:28:39.599Z","updated_at":"2025-12-27T14:06:38.127Z","closed_at":"2025-12-27T14:06:38.127Z","parent_id":"cell--tsysh-mjndvw6a7rr","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjndvw6pjra","title":"Port missing DoLcsAlgorithm edge case logic from C# (lines 6248-7144)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-26T21:28:39.601Z","updated_at":"2025-12-27T14:06:49.146Z","closed_at":"2025-12-27T14:06:49.146Z","parent_id":"cell--tsysh-mjndvw6a7rr","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjndvw6q0up","title":"Create comprehensive gap analysis report document","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-26T21:28:39.602Z","updated_at":"2025-12-27T14:06:40.719Z","closed_at":"2025-12-27T14:06:40.719Z","parent_id":"cell--tsysh-mjndvw6a7rr","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnelpkhirk","title":"P0-2a: Implement XML element navigation for ComparisonUnit","description":"**C# Lines:** 7181-7195 (~14 lines)\n**Effort:** 1-2 days\n\n## Required Implementation\n\nNavigate from ComparisonUnitGroup to XML table element:\n\n```csharp\n// C# 7181-7195\nvar firstContentAtom = tblGroup.DescendantContentAtoms().FirstOrDefault();\nvar tblElement = firstContentAtom\n    .AncestorElements\n    .Reverse()\n    .FirstOrDefault(a => a.Name == W.tbl);\n```\n\n## Rust Requirements\n1. Add `descendant_content_atoms()` method to `ComparisonUnitGroup`\n2. Add `ancestor_elements` access to `ComparisonUnitAtom`\n3. Implement XML traversal to find parent table element\n\n## Dependency\nRequired by P0-2b (merged cell detection). Without this, cannot navigate from comparison units to XML structure.\n\n## Reference\n- Source: history/SYNTHESIS_LCS_GAP_ANALYSIS.md (P0-2)\n- C# Source: OpenXmlPowerTools/WmlComparer.cs:7181-7195","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-26T21:48:44.081Z","updated_at":"2025-12-27T14:10:27.746Z","closed_at":"2025-12-27T14:10:27.746Z","parent_id":"cell--tsysh-mjnelpk5g6p","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnelpkjx2m","title":"P0-2b: Implement merged cell detection (check_table_has_merged_cells)","description":"**Impact:** Incorrect diffs for tables with merged cells (silent failures)\n**C# Lines:** 7197-7203 (~6 lines)\n**Rust Status:** âš ï¸ STUB IMPLEMENTATION (always returns `false`)\n**Effort:** 1-2 days implementation + 1-2 days testing\n\n## Current Stub (WRONG)\n```rust\n// redline-rs/crates/redline-core/src/wml/lcs_algorithm.rs:1434-1436\nfn check_table_has_merged_cells(_table_group: &ComparisonUnitGroup) -> bool {\n    false  // âš ï¸ ALWAYS RETURNS FALSE\n}\n```\n\n## Required Implementation\n```csharp\n// C# 7197-7203\nvar containsMerged = tblElement\n    .Descendants()\n    .Any(d => d.Name == W.vMerge || d.Name == W.gridSpan);\n```\n\n## Why Critical\n- Without this, merged cell logic (Branches 2 & 3 in DoLcsAlgorithmForTable) **never executes**\n- Algorithm works ONLY for simple tables without merged cells\n- ~40% of table comparison logic is effectively disabled\n\n## Dependencies\nRequires P0-2a (XML element navigation) to be completed first.\n\n## Reference\n- Source: history/SYNTHESIS_LCS_GAP_ANALYSIS.md (P0-2)\n- C# Source: OpenXmlPowerTools/WmlComparer.cs:7197-7203","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-26T21:48:44.083Z","updated_at":"2025-12-27T14:10:29.392Z","closed_at":"2025-12-27T14:10:29.392Z","parent_id":"cell--tsysh-mjnelpk5g6p","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnelpklw3l","title":"P0-3a: Implement mixed content paragraph mark priority logic","description":"**Impact:** Incorrect handling of mixed content (paragraphs + tables)\n**C# Lines:** 6827-6910 (~83 lines)\n**Effort:** 1-2 days implementation + 1 day testing\n\n## Missing Logic\n\nCheck if word groups end with paragraph marks to determine ordering:\n\n```csharp\n// C# 6827-6910\nvar firstWordIsParaMark = /* check first left word */;\nvar secondWordIsParaMark = /* check first right word */;\n\nif (firstWordIsParaMark && !secondWordIsParaMark) {\n    // Delete words first, then insert table\n} else {\n    // Insert table first, then delete words\n}\n```\n\n## Why Critical\nControls ordering of Deleted/Inserted sequences for mixed content. Wrong ordering produces incorrect diff output.\n\n## Reference\n- Source: history/SYNTHESIS_LCS_GAP_ANALYSIS.md (P0-3)\n- C# Source: OpenXmlPowerTools/WmlComparer.cs:6827-6910","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-26T21:48:44.085Z","updated_at":"2025-12-27T14:11:22.853Z","closed_at":"2025-12-27T14:11:22.853Z","parent_id":"cell--tsysh-mjnelpk5g6p","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnelpkm5vg","title":"P0-3b: Implement cell content flattening","description":"**Impact:** Optimization for cell-level comparisons\n**C# Lines:** 6771-6824 (~54 lines)\n**Effort:** 1-2 days implementation + 1 day testing\n\n## Missing Logic\n\n```csharp\n// C# 6771-6824\nif (firstIsCell && secondIsCell) {\n    var unknownCorrelatedSequence = new CorrelatedSequence();\n    unknownCorrelatedSequence.ComparisonUnitArray1 = \n        unknown.ComparisonUnitArray1\n        .SelectMany(cu => FlattenToComparisonUnitWordList(cu))\n        .ToArray();\n    // Recursively process flattened cell contents\n}\n```\n\n## Why Critical\n- Optimization for comparing table cells\n- Flattens cell contents to word-level for more granular comparison\n- Without this, cell comparisons may be less accurate\n\n## Reference\n- Source: history/SYNTHESIS_LCS_GAP_ANALYSIS.md (P0-3)\n- C# Source: OpenXmlPowerTools/WmlComparer.cs:6771-6824","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-26T21:48:44.086Z","updated_at":"2025-12-27T14:10:30.374Z","closed_at":"2025-12-27T14:10:30.374Z","parent_id":"cell--tsysh-mjnelpk5g6p","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnelpkpcf6","title":"P0-3c: Implement word/row conflict resolution","description":"**Impact:** Prevents incorrect diff ordering\n**C# Lines:** ~83 lines (scattered through content type grouping)\n**Effort:** 2-3 days implementation + 1 day testing\n\n## Missing Logic\n\nDetect word vs row type mismatches and order Deleted/Inserted based on paragraph mark presence.\n\n## Why Critical\n- Word/row conflicts can occur in mixed content documents\n- Incorrect resolution leads to wrong diff ordering\n- Affects documents with tables adjacent to paragraphs\n\n## Reference\n- Source: history/SYNTHESIS_LCS_GAP_ANALYSIS.md (P0-3)\n- C# Source: OpenXmlPowerTools/WmlComparer.cs (content type grouping section)","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-26T21:48:44.089Z","updated_at":"2025-12-27T14:10:31.426Z","closed_at":"2025-12-27T14:10:31.426Z","parent_id":"cell--tsysh-mjnelpk5g6p","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnelpkbj8j","title":"P0-1: Paragraph boundary preservation in DoLcsAlgorithm","description":"**Impact:** Core correctness - paragraphs split incorrectly, broken document structure\n**C# Lines:** 6927-7130 (~204 lines)\n**Rust Status:** âŒ NOT IMPLEMENTED\n**Effort:** 4-5 days implementation + 2-3 days testing\n\n## Missing Logic\n\n1. **Pre-LCS paragraph content calculation** (C# 6936-6987)\n   - Calculate `remainingInLeftParagraph` / `remainingInRightParagraph`\n   - Determine how much content before LCS match belongs to same paragraph\n\n2. **Before-paragraph content handling** (C# 6989-7028)\n   - Create Deleted/Inserted/Unknown sequences for content before current paragraph\n\n3. **Within-paragraph remainder handling** (C# 7030-7069)\n   - Handle content within same paragraph as LCS but before match starts\n\n4. **Post-LCS paragraph extension** (C# 7095-7122)\n   - When LCS doesn't end on paragraph boundary, extend Unknown to next paragraph mark\n\n## Current Rust Behavior (WRONG)\n```rust\n// Lines 813-846: Simple prefix/match/suffix with NO paragraph awareness\nnew_sequence.push(CorrelatedSequence {\n    comparison_unit_array_1: cul1[..current_i1].to_vec(),\n    comparison_unit_array_2: cul2[..current_i2].to_vec(),\n    correlation_status: CorrelationStatus::Unknown,\n});\n```\n\n## Reference\n- Source: history/SYNTHESIS_LCS_GAP_ANALYSIS.md (P0-1)\n- C# Source: OpenXmlPowerTools/WmlComparer.cs:6927-7130","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-26T21:48:44.075Z","updated_at":"2025-12-27T14:18:26.105Z","closed_at":"2025-12-27T14:18:26.105Z","parent_id":"cell--tsysh-mjnelpk5g6p","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnelpks39l","title":"P1-1: Implement paragraph-aware prefix splitting in FindCommonAtBeginningAndEnd","description":"**Impact:** Less granular correlation after common prefixes\n**C# Lines:** 4548-4605 (~57 lines)\n**Rust Status:** âŒ NOT IMPLEMENTED\n**Effort:** 1-2 days implementation + 1 day testing\n\n## Missing Logic\n\nAfter finding a common prefix, when both sides have remaining content:\n\n```csharp\n// C# 4548-4605\nvar first1 = commonSeq[commonSeq.Length - 1] as ComparisonUnitWord;\nvar lastContentAtom = first1?.DescendantContentAtoms().LastOrDefault();\n\nif (lastContentAtom != null && lastContentAtom.ContentElement.Name != W.pPr) {\n    var remaining1Split = SplitAtParagraphMark(remaining1);\n    var remaining2Split = SplitAtParagraphMark(remaining2);\n    \n    if (remaining1Split.Length == 1 && remaining2Split.Length == 1) {\n        // Create 1 Unknown\n    } else if (remaining1Split.Length == 2 && remaining2Split.Length == 2) {\n        // Create 2 Unknowns (before/after paragraph mark)\n    }\n}\n```\n\n## Current Rust Behavior (LESS GRANULAR)\n```rust\n// Lines 428-432: Always create single Unknown\nnew_sequence.push(CorrelatedSequence {\n    comparison_unit_array_1: units1[count_common_at_beginning..].to_vec(),\n    comparison_unit_array_2: units2[count_common_at_beginning..].to_vec(),\n    correlation_status: CorrelationStatus::Unknown,\n});\n```\n\n## Impact Analysis\n- Rust produces one large Unknown where C# produces multiple smaller Unknowns\n- Affects downstream comparison granularity\n- May reduce revision tracking accuracy at paragraph boundaries\n\n## Dependencies\nRequires P1-1a (SplitAtParagraphMark helper) to be completed first.\n\n## Reference\n- Source: history/SYNTHESIS_LCS_GAP_ANALYSIS.md (P1-1)\n- C# Source: OpenXmlPowerTools/WmlComparer.cs:4548-4605","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-26T21:48:44.092Z","updated_at":"2025-12-27T14:28:13.783Z","closed_at":"2025-12-27T14:28:13.783Z","parent_id":"cell--tsysh-mjnelpk5g6p","dependencies":[],"labels":[],"comments":[]}
{"id":"cell--tsysh-mjnelpkukc9","title":"P1-1a: Implement SplitAtParagraphMark helper","description":"**C# Lines:** ~20 lines\n**Effort:** 0.5-1 day\n\n## Required Implementation\n\nHelper function to split a ComparisonUnit array at paragraph mark boundaries.\n\n```csharp\n// Split array at first paragraph mark found\nprivate static ComparisonUnit[][] SplitAtParagraphMark(ComparisonUnit[] cua) {\n    for (int i = 0; i < cua.Length; i++) {\n        if (IsParagraphMark(cua[i])) {\n            return new[] {\n                cua.Take(i + 1).ToArray(),  // Including para mark\n                cua.Skip(i + 1).ToArray()   // After para mark\n            };\n        }\n    }\n    return new[] { cua };  // No para mark found\n}\n```\n\n## Dependency\nRequired by P1-1 (paragraph-aware prefix splitting).\n\n## Reference\n- Source: history/SYNTHESIS_LCS_GAP_ANALYSIS.md (P1-1)\n- Consider creating `paragraph_utils.rs` module for this and FindIndexOfNextParaMark","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-26T21:48:44.094Z","updated_at":"2025-12-27T14:28:11.616Z","closed_at":"2025-12-27T14:28:11.616Z","parent_id":"cell--tsysh-mjnelpk5g6p","dependencies":[],"labels":[],"comments":[]}
